var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function l(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function a(t,e,n,s,i,o,r){const a=function(t,e,n,s){if(t[2]&&s){const i=t[2](s(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|i[s];return t}return e.dirty|i}return e.dirty}(e,s,i,o);if(a){const i=l(e,n,s,r);t.p(i,a)}}function c(t,e){t.appendChild(e)}function h(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function _(t){return""===t?null:+t}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function y(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}let w;function $(t){w=t}function b(){if(!w)throw new Error("Function called outside component initialization");return w}const P=[],A=[],M=[],k=[],C=Promise.resolve();let T=!1;function E(t){M.push(t)}function F(t){k.push(t)}let S=!1;const I=new Set;function R(){if(!S){S=!0;do{for(let t=0;t<P.length;t+=1){const e=P[t];$(e),B(e.$$)}for($(null),P.length=0;A.length;)A.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];I.has(e)||(I.add(e),e())}M.length=0}while(P.length);for(;k.length;)k.pop()();T=!1,S=!1,I.clear()}}function B(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const U=new Set;let D;function G(t,e){t&&t.i&&(U.delete(t),t.i(e))}function L(t,e,n,s){if(t&&t.o){if(U.has(t))return;U.add(t),D.c.push((()=>{U.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function q(t,e){t.d(1),e.delete(t.key)}function O(t,e,n,s,i,o,r,l,a,c,h,u){let d=t.length,f=o.length,p=d;const g={};for(;p--;)g[t[p].key]=p;const m=[],_=new Map,v=new Map;for(p=f;p--;){const t=u(i,o,p),l=n(t);let a=r.get(l);a?s&&a.p(t,e):(a=c(l,t),a.c()),_.set(l,m[p]=a),l in g&&v.set(l,Math.abs(p-g[l]))}const x=new Set,y=new Set;function w(t){G(t,1),t.m(l,h),r.set(t.key,t),h=t.first,f--}for(;d&&f;){const e=m[f-1],n=t[d-1],s=e.key,i=n.key;e===n?(h=e.first,d--,f--):_.has(i)?!r.has(s)||x.has(s)?w(e):y.has(i)?d--:v.get(s)>v.get(i)?(y.add(s),w(e)):(x.add(i),d--):(a(n,r),d--)}for(;d--;){const e=t[d];_.has(e.key)||a(e,r)}for(;f;)w(m[f-1]);return m}function Y(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function j(t){t&&t.c()}function z(t,n,o,r){const{fragment:l,on_mount:a,on_destroy:c,after_update:h}=t.$$;l&&l.m(n,o),r||E((()=>{const n=a.map(e).filter(i);c?c.push(...n):s(n),t.$$.on_mount=[]})),h.forEach(E)}function H(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(P.push(t),T||(T=!0,C.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,i,o,r,l,a,c=[-1]){const h=w;$(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:i.context||[]),callbacks:n(),dirty:c,skip_bound:!1};let f=!1;if(d.ctx=o?o(e,i.props||{},((t,n,...s)=>{const i=s.length?s[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),f&&N(e,t)),n})):[],d.update(),f=!0,s(d.before_update),d.fragment=!!r&&r(d.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);d.fragment&&d.fragment.l(t),t.forEach(u)}else d.fragment&&d.fragment.c();i.intro&&G(e.$$.fragment),z(e,i.target,i.anchor,i.customElement),R()}$(h)}class W{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function V(t){let e,n;const s=t[1].default,i=function(t,e,n,s){if(t){const i=l(t,e,n,s);return t[0](i)}}(s,t,t[0],null);return{c(){e=d("div"),i&&i.c(),m(e,"class","control-column svelte-cyesi7")},m(t,s){h(t,e,s),i&&i.m(e,null),n=!0},p(t,[e]){i&&i.p&&(!n||1&e)&&a(i,s,t,t[0],e,null,null)},i(t){n||(G(i,t),n=!0)},o(t){L(i,t),n=!1},d(t){t&&u(e),i&&i.d(t)}}}function J(t,e,n){let{$$slots:s={},$$scope:i}=e;return t.$$set=t=>{"$$scope"in t&&n(0,i=t.$$scope)},[i,s]}class K extends W{constructor(t){super(),X(this,t,J,V,o,{})}}const Q=[];function Z(e,n=t){let s;const i=[];function r(t){if(o(e,t)&&(e=t,s)){const t=!Q.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),Q.push(n,e)}if(t){for(let t=0;t<Q.length;t+=2)Q[t][0](Q[t+1]);Q.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(o,l=t){const a=[o,l];return i.push(a),1===i.length&&(s=n(r)||t),o(e),()=>{const t=i.indexOf(a);-1!==t&&i.splice(t,1),0===i.length&&(s(),s=null)}}}}const tt=Z(100),et=Z(2),nt=Z(0),st=Z(0),it=Z(!1),ot=Z(!1),rt=Z([]);class lt{constructor(t,e,n){this._id=t,this._name=e,this._colors=n}get id(){return this._id}get name(){return this._name}get colors(){return this._colors}}class at{constructor(t,e=1,n=1){this._value=t,this._ratio=e,this._sizeFactor=n}get value(){return this._value}get ratio(){return this._ratio}get sizeFactor(){return this._sizeFactor}}class ct{static loadDefaultPalettes(){ct._defaultPalettes=new Map,ct._defaultPalettes.set("green",new lt("green","Green",[new at("#6C7C52"),new at("#4A4F44"),new at("#3B3845"),new at("#B2B096")])),ct._defaultPalettes.set("green2",new lt("green2","Green2",[new at("#6C7C52"),new at("#4A4F44"),new at("#3B3845"),new at("#B2B096"),new at("#a53434",.2,1),new at("#c2c248",.2,.5)])),ct._defaultPalettes.set("desert",new lt("desert","Desert",[new at("#B8A79B"),new at("#72625D"),new at("#A69887"),new at("#6D4C2D")])),ct._defaultPalettes.set("uc1",new lt("uc1","UC1",[new at("#C4B9B5"),new at("#683A31"),new at("#4A5F56")])),ct._defaultPalettes.set("uc2",new lt("uc2","UC2",[new at("#262527"),new at("#513A3E"),new at("#424B50")]))}static loadUserPalettes(){this._userPalettes=new Map;JSON.parse(window.localStorage.getItem("userPalettes")||"[]").forEach((t=>{let e=t._colors;e=e.length>0&&void 0===e[0]._ratio?e.map((t=>new at(t))):e.map((t=>new at(t._value,t._ratio,t._sizeFactor)));const n=new lt(t._id,t._name,e);this._userPalettes.set(n.id,n)}))}static saveUserPalettes(){let t=[];this._userPalettes.forEach((e=>{t.push(e)})),window.localStorage.setItem("userPalettes",JSON.stringify(t))}static setUserPalette(t){this._userPalettes.set(t.id,t),this.saveUserPalettes()}static deleteUserPalette(t){this._userPalettes.delete(t),this.saveUserPalettes()}static getDefaultPalettes(){return this._defaultPalettes}static getUserPalettes(){return this._userPalettes}static getBaseColorFromPalette(t){return(this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors[0].value}static colorGeneratorFromPalette(t){return this.colorGenerator((this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors)}static*colorGenerator(t){let e=t;for(t.length>0&&"string"==typeof t[0]&&(e=e.map((t=>new at(t))));;){let t=this.range(0,e.length-1);for(let e=t.length;1<e;e--){let n=Math.floor(Math.random()*e);[t[n],t[e-1]]=[t[e-1],t[n]]}for(let n=0;n<t.length;n++){e[t[n]].ratio>Math.random()&&(yield e[t[n]])}}}}function ht(t,e,n){const s=t.slice();return s[31]=e[n],s[32]=e,s[33]=n,s}function ut(t,e,n){const s=t.slice();return s[34]=e[n][0],s[35]=e[n][1],s}function dt(t,e,n){const s=t.slice();return s[34]=e[n][0],s[35]=e[n][1],s}function ft(t){let e,n,i,o,r,l,a,_,y,w,$,b,P,A,M,k,C,T,E,F,S,I,R,B,U,D,G,L,q,O,Y;return{c(){e=d("div"),n=d("div"),n.textContent="Pattern Parameter",i=p(),o=d("div"),r=d("div"),l=f("Number of Points ("),a=d("span"),_=f(t[2]),y=f(")"),w=p(),$=d("div"),b=d("input"),P=p(),A=d("div"),M=d("div"),k=f("Camo Depth ("),C=d("span"),T=f(t[3]),E=f(")"),F=p(),S=d("div"),I=d("input"),R=p(),B=d("div"),U=d("div"),U.textContent="Control",D=p(),G=d("span"),G.textContent="Animate",L=p(),q=d("span"),q.textContent="Mouse Track",m(n,"class","control-section-title svelte-hul5os"),m(a,"id","num-points-val"),m(r,"class","control-section-sub-title svelte-hul5os"),m(b,"type","range"),m(b,"name","num-points"),m(b,"min","1"),m(b,"max","1000"),m(b,"class","svelte-hul5os"),m(o,"class","control-section-sub svelte-hul5os"),m(C,"id","camo-depth-val"),m(M,"class","control-section-sub-title svelte-hul5os"),m(I,"type","range"),m(I,"name","camo-depth"),m(I,"min","1"),m(I,"max","20"),m(I,"class","svelte-hul5os"),m(A,"class","control-section-sub svelte-hul5os"),m(U,"class","control-section-sub-title svelte-hul5os"),m(G,"class","button svelte-hul5os"),m(q,"class","button svelte-hul5os"),m(B,"class","control-section-sub svelte-hul5os"),m(e,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,i),c(e,o),c(o,r),c(r,l),c(r,a),c(a,_),c(r,y),c(o,w),c(o,$),c($,b),x(b,t[2]),c(e,P),c(e,A),c(A,M),c(M,k),c(M,C),c(C,T),c(M,E),c(A,F),c(A,S),c(S,I),x(I,t[3]),c(e,R),c(e,B),c(B,U),c(B,D),c(B,G),c(B,L),c(B,q),O||(Y=[g(b,"change",t[20]),g(b,"input",t[20]),g(I,"change",t[21]),g(I,"input",t[21]),g(G,"mousedown",t[11]),g(q,"mousedown",t[12])],O=!0)},p(t,e){4&e[0]&&v(_,t[2]),4&e[0]&&x(b,t[2]),8&e[0]&&v(T,t[3]),8&e[0]&&x(I,t[3])},d(t){t&&u(e),O=!1,s(Y)}}}function pt(t,e){let n,s,i,o,r,l,a,_,v,x,w=e[35].name+"";return{key:t,first:null,c(){n=d("div"),s=d("label"),i=d("input"),o=p(),r=d("span"),r.innerHTML='<span class="inside svelte-hul5os"></span>',l=p(),a=d("span"),_=f(w),m(i,"type","radio"),i.__value=e[34],i.value=i.__value,m(i,"class","svelte-hul5os"),e[24][0].push(i),m(r,"class","outside svelte-hul5os"),m(a,"class","radio-name"),m(s,"class","radio svelte-hul5os"),y(n,"width","100%"),y(n,"display","flex"),this.first=n},m(t,u){h(t,n,u),c(n,s),c(s,i),i.checked=i.__value===e[0],c(s,o),c(s,r),c(s,l),c(s,a),c(a,_),v||(x=g(i,"change",e[23]),v=!0)},p(t,n){e=t,1&n[0]&&(i.checked=i.__value===e[0])},d(t){t&&u(n),e[24][0].splice(e[24][0].indexOf(i),1),v=!1,x()}}}function gt(t,e){let n,o,r,l,a,_,x,w,$,b,P,A,M,k,C,T,E=e[35].name+"";return{key:t,first:null,c(){n=d("div"),o=d("label"),r=d("input"),a=p(),_=d("span"),_.innerHTML='<span class="inside svelte-hul5os"></span>',x=p(),w=d("span"),$=f(E),b=p(),P=d("span"),P.innerHTML='<i class="fas fa-edit"></i>',A=p(),M=d("span"),M.innerHTML='<i class="far fa-trash-alt"></i>',k=p(),m(r,"type","radio"),r.__value=l=e[34],r.value=r.__value,m(r,"class","svelte-hul5os"),e[24][0].push(r),m(_,"class","outside svelte-hul5os"),m(w,"class","radio-name"),m(o,"class","radio svelte-hul5os"),m(P,"class","icon-button svelte-hul5os"),m(M,"class","icon-button svelte-hul5os"),y(n,"width","100%"),y(n,"display","flex"),y(n,"align-items","center"),this.first=n},m(t,s){h(t,n,s),c(n,o),c(o,r),r.checked=r.__value===e[0],c(o,a),c(o,_),c(o,x),c(o,w),c(w,$),c(n,b),c(n,P),c(n,A),c(n,M),c(n,k),C||(T=[g(r,"change",e[25]),g(P,"click",(function(){i(e[18](e[35]))&&e[18](e[35]).apply(this,arguments)})),g(M,"click",(function(){i(e[19](e[35]))&&e[19](e[35]).apply(this,arguments)}))],C=!0)},p(t,n){e=t,16&n[0]&&l!==(l=e[34])&&(r.__value=l,r.value=r.__value),1&n[0]&&(r.checked=r.__value===e[0]),16&n[0]&&E!==(E=e[35].name+"")&&v($,E)},d(t){t&&u(n),e[24][0].splice(e[24][0].indexOf(r),1),C=!1,s(T)}}}function mt(t){let e,n,i,o,r,l,a,_,v,x,y,w,$,b,P,A,M,k,C=[],T=new Map,E=[],F=new Map,S="m90p2"===t[1]&&ft(t),I=[...t[8]];const R=t=>t[34];for(let e=0;e<I.length;e+=1){let n=dt(t,I,e),s=R(n);T.set(s,C[e]=pt(s,n))}let B=[...t[4]];const U=t=>t[34];for(let e=0;e<B.length;e+=1){let n=ut(t,B,e),s=U(n);F.set(s,E[e]=gt(s,n))}return{c(){e=d("div"),n=d("div"),n.textContent="Camo Pattern",i=p(),o=d("div"),r=d("span"),r.textContent="Refresh",l=p(),a=d("span"),a.textContent="Download",_=p(),S&&S.c(),v=p(),x=d("div"),y=d("div"),w=f("Color Palette\n                    "),$=d("span"),$.textContent="+Add",b=p(),P=d("div");for(let t=0;t<C.length;t+=1)C[t].c();A=p();for(let t=0;t<E.length;t+=1)E[t].c();m(n,"class","control-section-title svelte-hul5os"),m(r,"class","button svelte-hul5os"),m(a,"class","button svelte-hul5os"),m(o,"class","control-section-sub svelte-hul5os"),m(e,"class","control-section svelte-hul5os"),m($,"class","button small svelte-hul5os"),m(y,"class","control-section-title svelte-hul5os"),m(P,"class","control-section-sub svelte-hul5os"),m(x,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,i),c(e,o),c(o,r),c(o,l),c(o,a),h(s,_,u),S&&S.m(s,u),h(s,v,u),h(s,x,u),c(x,y),c(y,w),c(y,$),c(x,b),c(x,P);for(let t=0;t<C.length;t+=1)C[t].m(P,null);c(P,A);for(let t=0;t<E.length;t+=1)E[t].m(P,null);M||(k=[g(r,"mousedown",t[9]),g(a,"mousedown",t[10]),g($,"mousedown",t[22])],M=!0)},p(t,e){"m90p2"===t[1]?S?S.p(t,e):(S=ft(t),S.c(),S.m(v.parentNode,v)):S&&(S.d(1),S=null),257&e[0]&&(I=[...t[8]],C=O(C,e,R,1,t,I,T,P,q,pt,A,dt)),786449&e[0]&&(B=[...t[4]],E=O(E,e,U,1,t,B,F,P,q,gt,null,ut))},d(t){t&&u(e),t&&u(_),S&&S.d(t),t&&u(v),t&&u(x);for(let t=0;t<C.length;t+=1)C[t].d();for(let t=0;t<E.length;t+=1)E[t].d();M=!1,s(k)}}}function _t(t){let e,n;return e=new K({props:{$$slots:{default:[xt]},$$scope:{ctx:t}}}),{c(){j(e.$$.fragment)},m(t,s){z(e,t,s),n=!0},p(t,n){const s={};224&n[0]|512&n[1]&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function vt(t,e){let n,o,r,l,a,f,_,v;function w(){e[27].call(r,e[32],e[33])}return{key:t,first:null,c(){n=d("div"),o=d("label"),r=d("input"),l=p(),a=d("span"),a.innerHTML='<i class="far fa-trash-alt"></i>',f=p(),m(r,"type","color"),m(r,"class","svelte-hul5os"),m(a,"class","icon-button svelte-hul5os"),m(o,"class","svelte-hul5os"),y(n,"position","relative"),this.first=n},m(t,s){h(t,n,s),c(n,o),c(o,r),x(r,e[31].color),c(o,l),c(o,a),c(n,f),_||(v=[g(r,"input",w),g(r,"input",e[15]),g(a,"click",(function(){i(e[16](e[33]))&&e[16](e[33]).apply(this,arguments)}))],_=!0)},p(t,n){e=t,64&n[0]&&x(r,e[31].color)},d(t){t&&u(n),_=!1,s(v)}}}function xt(t){let e,n,i,o,r,l,a,_,v,w,$,b,P,A,M,k,C,T,E,F,S,I,R,B,U=[],D=new Map,G=t[6];const L=t=>t[33];for(let e=0;e<G.length;e+=1){let n=ht(t,G,e),s=L(n);D.set(s,U[e]=vt(s,n))}return{c(){e=d("div"),n=d("div"),n.textContent="Edit Color Palette",i=p(),o=d("span"),o.textContent="X Close",r=p(),l=d("div"),a=p(),_=d("div"),v=d("div"),v.textContent="Colors",w=p(),$=d("span"),$.textContent="Add Color",b=p();for(let t=0;t<U.length;t+=1)U[t].c();P=p(),A=d("div"),M=d("div"),M.textContent="Palette Name",k=p(),C=d("input"),T=p(),E=d("div"),F=d("button"),S=f("Save Color Palette"),m(n,"class","control-section-title svelte-hul5os"),y(n,"float","left"),m(o,"class","button small svelte-hul5os"),y(o,"float","right"),y(l,"clear","both"),m(v,"class","control-section-sub-title svelte-hul5os"),m($,"class","button full small svelte-hul5os"),m(_,"class","control-section-sub svelte-hul5os"),m(M,"class","control-section-sub-title svelte-hul5os"),m(C,"type","text"),m(C,"class","svelte-hul5os"),m(A,"class","control-section-sub svelte-hul5os"),m(F,"class","button full svelte-hul5os"),F.disabled=I=t[6].length<2||t[7]&&0===t[7].length,m(E,"class","control-section-sub svelte-hul5os"),y(E,"margin-top","1rem"),m(e,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,i),c(e,o),c(e,r),c(e,l),c(e,a),c(e,_),c(_,v),c(_,w),c(_,$),c(_,b);for(let t=0;t<U.length;t+=1)U[t].m(_,null);c(e,P),c(e,A),c(A,M),c(A,k),c(A,C),x(C,t[7]),c(e,T),c(e,E),c(E,F),c(F,S),R||(B=[g(o,"mousedown",t[26]),g($,"click",t[14]),g(C,"input",t[28]),g(F,"click",t[17])],R=!0)},p(t,e){98368&e[0]&&(G=t[6],U=O(U,e,L,1,t,G,D,_,q,vt,null,ht)),128&e[0]&&C.value!==t[7]&&x(C,t[7]),192&e[0]&&I!==(I=t[6].length<2||t[7]&&0===t[7].length)&&(F.disabled=I)},d(t){t&&u(e);for(let t=0;t<U.length;t+=1)U[t].d();R=!1,s(B)}}}function yt(t){let e,n,i,o,r;i=new K({props:{$$slots:{default:[mt]},$$scope:{ctx:t}}});let l=t[5]&&_t(t);return{c(){e=d("div"),n=d("div"),j(i.$$.fragment),o=p(),l&&l.c(),m(n,"class","control-columns svelte-hul5os"),m(e,"class","control-panel svelte-hul5os")},m(t,s){h(t,e,s),c(e,n),z(i,n,null),c(n,o),l&&l.m(n,null),r=!0},p(t,e){const o={};31&e[0]|512&e[1]&&(o.$$scope={dirty:e,ctx:t}),i.$set(o),t[5]?l?(l.p(t,e),32&e[0]&&G(l,1)):(l=_t(t),l.c(),G(l,1),l.m(n,null)):l&&(D={r:0,c:[],p:D},L(l,1,1,(()=>{l=null})),D.r||s(D.c),D=D.p)},i(t){r||(G(i.$$.fragment,t),G(l),r=!0)},o(t){L(i.$$.fragment,t),L(l),r=!1},d(t){t&&u(e),H(i),l&&l.d()}}}function wt(t,e,n){let s;r(t,rt,(t=>n(30,s=t)));let i,o,{camoPattern:l="m90p2"}=e,{colorPalette:a="green"}=e,c=[...ct.getDefaultPalettes()],h=[...ct.getUserPalettes()],u=!1,d=500,f=2,p=[{color:"#000000"}];function g(){n(5,u=!0),n(6,p=[]),n(7,o=void 0),i=void 0,m(!1)}function m(t=!0){n(6,p=p.concat({color:"#"+Math.floor(16777215*Math.random()).toString(16)})),t&&v()}function v(){!function(t,e,n=e){t.set(n)}(rt,s=p.map((t=>t.color)),s)}return t.$$set=t=>{"camoPattern"in t&&n(1,l=t.camoPattern),"colorPalette"in t&&n(0,a=t.colorPalette)},t.$$.update=()=>{12&t.$$.dirty[0]&&(tt.set(d),et.set(f))},[a,l,d,f,h,u,p,o,c,function(){nt.update((t=>(t+1)%2))},function(){st.update((t=>(t+1)%2))},function(){ot.update((t=>!t))},function(){it.update((t=>!t))},g,m,v,function(t){console.log(t),p.splice(t,1),n(6,p=[...p]),v()},function(){n(5,u=!1);let t=i||(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16),e=new lt(t,o,p.map((t=>new at(t.color))));ct.setUserPalette(e),n(4,h=[...ct.getUserPalettes()])},function(t){n(5,u=!0),n(0,a=i=t.id),n(6,p=t.colors.map((t=>({color:t})))),n(7,o=t.name)},function(t){window.confirm(`Delete ${t.name}?`)&&(ct.deleteUserPalette(t.id),n(4,h=[...ct.getUserPalettes()]))},function(){d=_(this.value),n(2,d)},function(){f=_(this.value),n(3,f)},()=>g(),function(){a=this.__value,n(0,a)},[[]],function(){a=this.__value,n(0,a)},()=>n(5,u=!1),function(t,e){t[e].color=this.value,n(6,p)},function(){o=this.value,n(7,o)}]}ct.ctor=(ct.loadDefaultPalettes(),ct.loadUserPalettes(),null),ct.range=(t,e)=>Array.from({length:e-t+1},((e,n)=>n+t));class $t extends W{constructor(t){super(),X(this,t,wt,yt,o,{camoPattern:1,colorPalette:0},[-1,-1])}}class bt{constructor(t,e,n=null){this._x=t,this._y=e,this._index=n}get coord(){return[this._x,this._y]}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get key(){return`${this.x},${this.y}`}get hasIndex(){return!!this._index}get keyIndex(){return this._index}get vec(){return[this.x,this.y]}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y}div(t){return this.x/=t,this.y/=t,this}static of(t,e){let n=`${t},${e}`;return void 0===this._cache[n]&&(this._cache[n]=new bt(t,e)),this._cache[n]}static randomOf(t=0,e=0,n,s){return bt.of(t+Math.random()*n,e+Math.random()*s)}static randomPointsOf(t,e,n,s){let i=[];for(let t=0;t<s;t++)i.push(2*Math.PI*Math.random());return i.sort(),i.map((s=>bt.of(t+n*Math.cos(s),e+n*Math.sin(s))))}static randomPoints2Of(t,e,n,s){let i=[],o=2*Math.PI*Math.random();for(let t=0;t<s;t++){let e=1.5*Math.random()-.75,n=2*Math.PI/s*t+e;i.push(n+o)}return i.sort(),i.map((s=>bt.of(t+n*Math.cos(s),e+n*Math.sin(s))))}}bt._cache={};class Pt{constructor(t,e,n,s=1){this._r=t,this._g=e,this._b=n,this._a=s}get r(){return this._r}get g(){return this._g}get b(){return this._b}get vec(){return[this._r,this._g,this._b,this._a]}static fromHex(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return null===e&&console.log("#@@@@@",t),new Pt(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))}}class At{constructor(t,e,n){this._center=t,this._radius=e,this._color=n}get center(){return this._center}get radius(){return this._radius}get color(){return this._color}isContaining(t){return this.center.dist(t)<this.radius}}class Mt{}Mt.range=(t,e)=>Array.from({length:e-t+1},((e,n)=>n+t));class kt{constructor(t,e){t.hasIndex&&e.hasIndex?t.keyIndex<e.keyIndex?(this._start=t,this._end=e):(this._start=e,this._end=t):t.x<=e.x?(this._start=t,this._end=e):(this._start=e,this._end=t)}get start(){return this._start}get end(){return this._end}get key(){return`${this.start.key}/${this.end.key}`}get keyIndex(){return`${this.start.keyIndex}-${this.end.keyIndex}`}equals(t){return this._start.equals(t._start)&&this._end.equals(t._end)||this._start.equals(t._end)&&this._end.equals(t._start)}}class Ct extends class{constructor(t,e,n,s=[]){this._points=t,this._color=e,this._strokeColor=n,this._colors=s,this._center=this._points.reduce(((t,e,n,s)=>new bt(t.x+e.x,t.y+e.y))).div(this._points.length),this._points.sort(this.comparePoints.bind(this)),this.setMinMax()}get points(){return this._points}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get key(){return this.points.map((t=>t.key)).join("/")}get keyIndex(){return this.points.map((t=>t.keyIndex.toString())).join("/")}equals(t){if(this.points.length!=t.points.length)return!1;for(let e=0;e<this.points.length;e++)if(!this.points[e].equals(t.points[e]))return!1;return!0}isContaining(t){let e=!1;if(t.x<this.minX||t.x>this.maxX||t.y<this.minY||t.y>this.maxY)return!1;for(let n=0,s=this.points.length-1;n<this.points.length;s=n++)this.points[n].y>t.y!=this.points[s].y>t.y&&t.x<(this.points[s].x-this.points[n].x)*(t.y-this.points[n].y)/(this.points[s].y-this.points[n].y)+this.points[n].x&&(e=!e);return e}setMinMax(){this.minX=this.points[0].x,this.maxX=this.points[0].x,this.minY=this.points[0].y,this.maxY=this.points[0].y;for(let t=1;t<this.points.length;t++){let e=this.points[t];this.minX=Math.min(e.x,this.minX),this.maxX=Math.max(e.x,this.maxX),this.minY=Math.min(e.y,this.minY),this.maxY=Math.max(e.y,this.maxY)}}comparePoints(t,e){if(t.equals(e))return 0;return(()=>{if(t.x-this._center.x>=0&&e.x-this._center.x<0)return!0;if(t.x-this._center.x<0&&e.x-this._center.x>=0)return!1;if(t.x-this._center.x==0&&e.x-this._center.x==0)return t.y-this._center.y>=0||e.y-this._center.y>=0?t.y>e.y:e.y>t.y;let n=(t.x-this._center.x)*(e.y-this._center.y)-(e.x-this._center.x)*(t.y-this._center.y);return n<0||!(n>0)&&(t.x-this._center.x)*(t.x-this._center.x)+(t.y-this._center.y)*(t.y-this._center.y)>(e.x-this._center.x)*(e.x-this._center.x)+(e.y-this._center.y)*(e.y-this._center.y)})()?1:-1}}{constructor(t,e,n=[]){if(3!=t.length)throw Error("Triangle must have 3 points");super(t,e,void 0,n)}get area(){return this._area||(this._area=Math.abs(.5*(this.points[0].x*(this.points[1].y-this.points[2].y)+this.points[1].x*(this.points[2].y-this.points[0].y)+this.points[2].x*(this.points[0].y-this.points[1].y)))),this._area}get edges(){return this._edges||(this._edges=[],this._edges.push(new kt(this.points[0],this.points[1])),this._edges.push(new kt(this.points[1],this.points[2])),this._edges.push(new kt(this.points[2],this.points[0]))),this._edges}getCircumcircle(){if(!this._circumcircle){const t=this.points[0].x,e=this.points[0].y,n=this.points[1].x,s=this.points[1].y,i=this.points[2].x,o=this.points[2].y,r=Math.pow(t,2),l=Math.pow(n,2),a=Math.pow(i,2),c=Math.pow(e,2),h=Math.pow(s,2),u=Math.pow(o,2),d=2*((n-t)*(o-e)-(s-e)*(i-t)),f=((o-e)*(l-r+h-c)+(e-s)*(a-r+u-c))/d,p=((t-i)*(l-r+h-c)+(n-t)*(a-r+u-c))/d,g=Math.sqrt(Math.pow(t-f,2)+Math.pow(e-p,2));this._circumcircle=new At(new bt(f,p),g,"white")}return this._circumcircle}}class Tt{static incrementAndGet(){return void 0===this._index&&(this._index=0),this._index++}static reset(){this._index=0}}class Et{constructor(t){this.ctx=t}drawPolygon(t,e,n){e?(this.ctx.fillStyle=e,this.ctx.strokeStyle=n||e):(this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.strokeColor||t.color),this.ctx.beginPath(),t.points.forEach(((t,e)=>{0===e?this.ctx.moveTo(...t.coord):this.ctx.lineTo(...t.coord)})),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill()}clearCanvas(){}}class Ft extends class{constructor(t){this.ctx=t}drawPolygon(t,e,n){e?(this.ctx.fillStyle=e,this.ctx.strokeStyle=n||e):(this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.strokeColor||t.color),this.ctx.beginPath(),t.points.forEach(((t,e)=>{0===e?this.ctx.moveTo(...t.coord):this.ctx.lineTo(...t.coord)})),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill()}}{constructor(t,e){super(t),this.activeTriangle=new Array(2),this.renderer=void 0===e?new Et(t):e}draw(t,e,n,s){let i;this.renderer.clearCanvas(),i=Array.isArray(n)?ct.colorGenerator(n):n,this.points=[];const o=Math.ceil(t/500),r=Math.ceil(e/500);if(s.skipPointGeneration&&this.triangles){this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];if(this.visitMap[e.keyIndex])continue;const n=i.next().value;this.makeCamouflage(e,n,s.camo_depth)}return}Tt.reset();for(let n=0;n<o+1;n++)for(let s=0;s<r+1;s++)this.points.push(new bt(t/o*n,e/r*s,Tt.incrementAndGet()));let l=s.num_points-1;Mt.range(0,l).forEach(((n,s)=>{this.points.push(new bt(Math.random()*t,Math.random()*e,Tt.incrementAndGet()))}));const a=Math.sqrt(t*t+e*e)/2,c=new bt(t/2,e/2),h=new bt(c.x-Math.sqrt(3)*a,c.y-a,Tt.incrementAndGet()),u=new bt(c.x+Math.sqrt(3)*a,c.y-a,Tt.incrementAndGet()),d=new bt(c.x,c.y+2*a,Tt.incrementAndGet()),f=new Ct([h,u,d],"pink");i.next();let p=[f];this.points.forEach(((t,e)=>{let n=[];p.forEach(((e,s)=>{e.getCircumcircle().isContaining(t)&&(n=n.concat(e.edges),delete p[s])})),n.map(((t,e)=>{for(let s=0;s<n.length;s++)if(e!=s&&t.equals(n[s]))return null;return t})).filter((t=>t)).forEach((e=>{p.push(new Ct([e.start,e.end,t],i.next().value.value))}))})),this.triangles=p.filter((t=>t)),this.triangleAreas=this.triangles.map((t=>t.area)).sort(((t,e)=>t-e)),this.triangleAreaMedian=this.triangleAreas[Math.floor(this.triangleAreas.length/2)],this.buildEdgeMap(),this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];if(this.visitMap[e.keyIndex])continue;const n=i.next().value;this.makeCamouflage(e,n,Math.ceil(s.camo_depth*n.sizeFactor))}}makeCamouflage(t,e,n,s=null){if(s=s||n,t.color=e.value,this.visitMap[t.keyIndex]=e.value,0==n)return void this.renderer.drawPolygon(t,e.value);let i=n===s,o=[];t.edges.forEach(((r,l)=>{const a=this.edgeMap[r.keyIndex].filter((e=>!e.equals(t)))[0];a&&o.push(a),a&&!this.visitMap[a.keyIndex]&&(i=!1,(a.area<5e3||Math.random()<n/s)&&this.makeCamouflage(a,e,n-1,s))})),i?0==o.length?console.error("Failed to find adjacentTriangle"):(t.color=this.visitMap[o[0].keyIndex],this.renderer.drawPolygon(t,t.color,t.color)):this.renderer.drawPolygon(t,e.value)}startAnimate(){this.interval=setInterval(this.animate.bind(this),50)}stopAnimate(){clearInterval(this.interval)}animate(){this.points.forEach(((t,e)=>{this.points[e].x+=4*(Math.random()-.5),this.points[e].y+=4*(Math.random()-.5)})),this.triangles.forEach((t=>{this.isActiveTriangle(t)?this.renderer.drawPolygon(t,"#FF0000"):this.adjacentPolygons&&this.adjacentPolygons[t.keyIndex]?this.renderer.drawPolygon(t,"#0000FF"):this.renderer.drawPolygon(t)}))}handleMouseMove(t){this.triangles.forEach((e=>{e.isContaining(t)?(this.updateActiveTriangle(e),this.renderer.drawPolygon(e,"#FF0000")):this.renderer.drawPolygon(e)})),Object.keys(this.adjacentPolygons).forEach((t=>{this.renderer.drawPolygon(this.adjacentPolygons[t],"#0000FF")}))}buildEdgeMap(){this.edgeMap={},this.triangles.forEach((t=>{t.edges.forEach((e=>{void 0===this.edgeMap[e.keyIndex]&&(this.edgeMap[e.keyIndex]=[]),this.edgeMap[e.keyIndex].push(t)}))}))}updateActiveTriangle(t){if(!this.isActiveTriangle(t)){this.activeTriangle[1]=this.activeTriangle[0],this.activeTriangle[0]=t,this.adjacentPolygons={};for(let e=0;e<t.edges.length;e++){const n=this.edgeMap[t.edges[e].keyIndex];n&&n.length>1&&n.forEach((e=>{e.equals(t)||(this.adjacentPolygons[e.keyIndex]=e)}))}}}isActiveTriangle(t){return this.activeTriangle[0]&&this.activeTriangle[0].equals(t)}}class St{static createShader(t,e,n){let s=t.createShader(e);if(t.shaderSource(s,n),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;console.log(t.getShaderInfoLog(s)),t.deleteShader(s)}static createAttribute2f(t,e,n,s){const i=t.getAttribLocation(e,n),o=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),[i,o]}static createAttribute4f(t,e,n,s){const i=t.getAttribLocation(e,n),o=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),[i,o]}static render(t,e,n){}}class It{constructor(t){this.gl=t,this.configureWebGL()}drawPolygon(t,e,n){const s=t.points.flatMap((n=>null!=e?Pt.fromHex(e).vec:Pt.fromHex(t.color).vec));this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexColorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(s),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t.points.flatMap((t=>t.vec))),this.gl.STATIC_DRAW),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,t.points.length)}clearCanvas(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.configureUniform(this.defaultProgram)}configureWebGL(t,e){void 0===t&&(t="attribute vec2 a_position;attribute vec4 a_vertex_color;uniform vec2 u_resolution;varying lowp vec4 v_color;void main(){vec2 zeroToOne=a_position/u_resolution;vec2 zeroToTwo=zeroToOne*2.0;vec2 clipSpace=zeroToTwo-1.0;gl_Position=vec4(clipSpace*vec2(1,-1),0,1);v_color=a_vertex_color;}"),void 0===e&&(e="precision mediump float;varying lowp vec4 v_color;void main(){vec4 normalVec=vec4(255.0,255.0,255.0,1.0);gl_FragColor=v_color/normalVec;}");const n=St.createShader(this.gl,this.gl.VERTEX_SHADER,t),s=St.createShader(this.gl,this.gl.FRAGMENT_SHADER,e);this.defaultProgram=this.wenGLCreateProgram(n,s),this.gl.useProgram(this.defaultProgram),this.configureUniform(this.defaultProgram),this.configureAttribute(this.defaultProgram),this.clearCanvas()}wenGLCreateProgram(t,e){const n=this.gl.createProgram();this.gl.attachShader(n,t),this.gl.attachShader(n,e),this.gl.linkProgram(n);if(this.gl.getProgramParameter(n,this.gl.LINK_STATUS))return n;this.gl.deleteProgram(n)}configureUniform(t){let e=this.gl.getUniformLocation(t,"u_resolution");this.gl.uniform2f(e,this.gl.canvas.width,this.gl.canvas.height)}configureAttribute(t){const[e,n]=St.createAttribute2f(this.gl,t,"a_position",new Float32Array([])),[s,i]=St.createAttribute4f(this.gl,t,"a_vertex_color",new Float32Array([]));this.positionBuffer=n,this.vertexColorBuffer=i}}function Rt(e){let n,i,o,r;return{c(){n=d("div"),i=d("canvas"),m(n,"class","canvas-wrapper svelte-pol47w")},m(t,s){h(t,n,s),c(n,i),e[6](i),o||(r=[g(window,"resize",e[5]),g(i,"mousemove",e[2])],o=!0)},p:t,i:t,o:t,d(t){t&&u(n),e[6](null),o=!1,s(r)}}}function Bt(t,e,n){let s,i;r(t,tt,(t=>n(11,s=t))),r(t,et,(t=>n(12,i=t)));let o,l,a,c,{pattern:h="m90p2"}=e,{color:u}=e,d=!1;var f;f=()=>{c=o.getContext("webgl"),a=new Ft(c,new It(c)),x()},b().$$.on_mount.push(f);const p=nt.subscribe((t=>x())),g=it.subscribe((t=>d=t)),m=ot.subscribe((t=>{a&&(t?a.startAnimate():a.stopAnimate())})),_=st.subscribe((function(){if(!o)return;let t=document.createElement("a");document.body.appendChild(t),t.setAttribute("download","camo-pattern.png"),t.setAttribute("href",o.toDataURL("image/png").replace("image/png","image/octet-stream")),t.click(),document.body.removeChild(t)})),v=rt.subscribe((t=>{x(ct.colorGenerator(t),!0)}));function x(t,e=!1){if(!c)return;let n=document.documentElement.clientWidth,r=document.documentElement.clientHeight;!function(t,e,n){o.setAttribute("width",t.toString()),o.setAttribute("height",e.toString())}(n,r),function(t,e,n,o=!1){if(n=n||ct.colorGeneratorFromPalette(u),"m90p1"===h)l.draw(t,e,n);else{if("m90p2"!==h)throw Error(`Unsupported pattern type: ${h}`);{const r={num_points:s,camo_depth:i,skipPointGeneration:o};a.draw(t,e,n,r)}}}(n,r,t,e)}!function(t){b().$$.before_update.push(t)}((()=>x())),function(t){b().$$.on_destroy.push(t)}((()=>{p(),g(),m(),_(),v()}));return t.$$set=t=>{"pattern"in t&&n(3,h=t.pattern),"color"in t&&n(4,u=t.color)},[o,x,function(t){d&&"m90p2"===h&&a.handleMouseMove(new bt(t.clientX,t.clientY))},h,u,()=>x(),function(t){A[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class Ut extends W{constructor(t){super(),X(this,t,Bt,Rt,o,{pattern:3,color:4})}}function Dt(t){let e,n,s,i,o,r,l;function a(e){t[3](e)}function f(e){t[4](e)}let g={};return void 0!==t[0]&&(g.camoPattern=t[0]),void 0!==t[1]&&(g.colorPalette=t[1]),n=new $t({props:g}),A.push((()=>Y(n,"camoPattern",a))),A.push((()=>Y(n,"colorPalette",f))),r=new Ut({props:{pattern:t[0],color:t[1]}}),{c(){e=d("main"),j(n.$$.fragment),o=p(),j(r.$$.fragment),m(e,"class","svelte-g2cdjv")},m(t,s){h(t,e,s),z(n,e,null),c(e,o),z(r,e,null),l=!0},p(t,[e]){const o={};!s&&1&e&&(s=!0,o.camoPattern=t[0],F((()=>s=!1))),!i&&2&e&&(i=!0,o.colorPalette=t[1],F((()=>i=!1))),n.$set(o);const l={};1&e&&(l.pattern=t[0]),2&e&&(l.color=t[1]),r.$set(l)},i(t){l||(G(n.$$.fragment,t),G(r.$$.fragment,t),l=!0)},o(t){L(n.$$.fragment,t),L(r.$$.fragment,t),l=!1},d(t){t&&u(e),H(n),H(r)}}}function Gt(t,e,n){let s,{name:i}=e,o="green";return t.$$set=t=>{"name"in t&&n(2,i=t.name)},[s,o,i,function(t){s=t,n(0,s)},function(t){o=t,n(1,o)}]}return new class extends W{constructor(t){super(),X(this,t,Gt,Dt,o,{name:2})}}({target:document.body,props:{name:"world"}})}();
