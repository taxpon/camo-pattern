var app=function(){"use strict";function t(){}function e(t){return t()}function s(){return Object.create(null)}function n(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,s,n){e.$$.on_destroy.push(function(e,...s){if(null==e)return t;const n=e.subscribe(...s);return n.unsubscribe?()=>n.unsubscribe():n}(s,n))}function a(t,e,s,n){return t[1]&&n?function(t,e){for(const s in e)t[s]=e[s];return t}(s.ctx.slice(),t[1](n(e))):s.ctx}function l(t,e,s,n,i,r,o){const l=function(t,e,s,n){if(t[2]&&n){const i=t[2](n(s));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],s=Math.max(e.dirty.length,i.length);for(let n=0;n<s;n+=1)t[n]=e.dirty[n]|i[n];return t}return e.dirty|i}return e.dirty}(e,n,i,r);if(l){const i=a(e,s,n,o);t.p(i,l)}}function c(t,e){t.appendChild(e)}function h(t,e,s){t.insertBefore(e,s||null)}function u(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,s,n){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s,n)}function x(t,e,s){null==s?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s)}function m(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function _(t,e,s,n){t.style.setProperty(e,s,n?"important":"")}let w;function b(t){w=t}function P(){if(!w)throw new Error("Function called outside component initialization");return w}const $=[],A=[],M=[],k=[],C=Promise.resolve();let E=!1;function T(t){M.push(t)}function F(t){k.push(t)}let S=!1;const I=new Set;function R(){if(!S){S=!0;do{for(let t=0;t<$.length;t+=1){const e=$[t];b(e),B(e.$$)}for(b(null),$.length=0;A.length;)A.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];I.has(e)||(I.add(e),e())}M.length=0}while($.length);for(;k.length;)k.pop()();E=!1,S=!1,I.clear()}}function B(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const U=new Set;let D;function G(t,e){t&&t.i&&(U.delete(t),t.i(e))}function L(t,e,s,n){if(t&&t.o){if(U.has(t))return;U.add(t),D.c.push((()=>{U.delete(t),n&&(s&&t.d(1),n())})),t.o(e)}}function q(t,e){t.d(1),e.delete(t.key)}function O(t,e,s,n,i,r,o,a,l,c,h,u){let d=t.length,f=r.length,p=d;const g={};for(;p--;)g[t[p].key]=p;const x=[],m=new Map,y=new Map;for(p=f;p--;){const t=u(i,r,p),a=s(t);let l=o.get(a);l?n&&l.p(t,e):(l=c(a,t),l.c()),m.set(a,x[p]=l),a in g&&y.set(a,Math.abs(p-g[a]))}const v=new Set,_=new Set;function w(t){G(t,1),t.m(a,h),o.set(t.key,t),h=t.first,f--}for(;d&&f;){const e=x[f-1],s=t[d-1],n=e.key,i=s.key;e===s?(h=e.first,d--,f--):m.has(i)?!o.has(n)||v.has(n)?w(e):_.has(i)?d--:y.get(n)>y.get(i)?(_.add(n),w(e)):(v.add(i),d--):(l(s,o),d--)}for(;d--;){const e=t[d];m.has(e.key)||l(e,o)}for(;f;)w(x[f-1]);return x}function Y(t,e,s){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=s,s(t.$$.ctx[n]))}function j(t){t&&t.c()}function z(t,s,r,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:h}=t.$$;a&&a.m(s,r),o||T((()=>{const s=l.map(e).filter(i);c?c.push(...s):n(s),t.$$.on_mount=[]})),h.forEach(T)}function H(t,e){const s=t.$$;null!==s.fragment&&(n(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&($.push(t),E||(E=!0,C.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,i,r,o,a,l,c=[-1]){const h=w;b(e);const d=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:i.context||[]),callbacks:s(),dirty:c,skip_bound:!1};let f=!1;if(d.ctx=r?r(e,i.props||{},((t,s,...n)=>{const i=n.length?n[0]:s;return d.ctx&&a(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),f&&N(e,t)),s})):[],d.update(),f=!0,n(d.before_update),d.fragment=!!o&&o(d.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);d.fragment&&d.fragment.l(t),t.forEach(u)}else d.fragment&&d.fragment.c();i.intro&&G(e.$$.fragment),z(e,i.target,i.anchor,i.customElement),R()}b(h)}class W{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function V(t){let e,s;const n=t[1].default,i=function(t,e,s,n){if(t){const i=a(t,e,s,n);return t[0](i)}}(n,t,t[0],null);return{c(){e=d("div"),i&&i.c(),x(e,"class","control-column svelte-cyesi7")},m(t,n){h(t,e,n),i&&i.m(e,null),s=!0},p(t,[e]){i&&i.p&&(!s||1&e)&&l(i,n,t,t[0],e,null,null)},i(t){s||(G(i,t),s=!0)},o(t){L(i,t),s=!1},d(t){t&&u(e),i&&i.d(t)}}}function J(t,e,s){let{$$slots:n={},$$scope:i}=e;return t.$$set=t=>{"$$scope"in t&&s(0,i=t.$$scope)},[i,n]}class K extends W{constructor(t){super(),X(this,t,J,V,r,{})}}const Q=[];function Z(e,s=t){let n;const i=[];function o(t){if(r(e,t)&&(e=t,n)){const t=!Q.length;for(let t=0;t<i.length;t+=1){const s=i[t];s[1](),Q.push(s,e)}if(t){for(let t=0;t<Q.length;t+=2)Q[t][0](Q[t+1]);Q.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(r,a=t){const l=[r,a];return i.push(l),1===i.length&&(n=s(o)||t),r(e),()=>{const t=i.indexOf(l);-1!==t&&i.splice(t,1),0===i.length&&(n(),n=null)}}}}const tt=Z(100),et=Z(2),st=Z(0),nt=Z(0),it=Z(!1),rt=Z(!1),ot=Z([]);class at{constructor(t,e,s){this._id=t,this._name=e,this._colors=s}get id(){return this._id}get name(){return this._name}get colors(){return this._colors}}class lt{constructor(t,e=1,s=1){this._value=t,this._ratio=e,this._sizeFactor=s}get value(){return this._value}get ratio(){return this._ratio}get sizeFactor(){return this._sizeFactor}}class ct{static loadDefaultPalettes(){ct._defaultPalettes=new Map,ct._defaultPalettes.set("green",new at("green","Green",[new lt("#6C7C52"),new lt("#4A4F44"),new lt("#3B3845"),new lt("#B2B096")])),ct._defaultPalettes.set("green2",new at("green2","Green2",[new lt("#6C7C52"),new lt("#4A4F44"),new lt("#3B3845"),new lt("#B2B096"),new lt("#a53434",.2,1),new lt("#c2c248",.2,.5)])),ct._defaultPalettes.set("desert",new at("desert","Desert",[new lt("#B8A79B"),new lt("#72625D"),new lt("#A69887"),new lt("#6D4C2D")])),ct._defaultPalettes.set("uc1",new at("uc1","UC1",[new lt("#C4B9B5"),new lt("#683A31"),new lt("#4A5F56")])),ct._defaultPalettes.set("uc2",new at("uc2","UC2",[new lt("#262527"),new lt("#513A3E"),new lt("#424B50")]))}static loadUserPalettes(){this._userPalettes=new Map;JSON.parse(window.localStorage.getItem("userPalettes")||"[]").forEach((t=>{let e=t._colors;e=e.length>0&&void 0===e[0]._ratio?e.map((t=>new lt(t))):e.map((t=>new lt(t._value,t._ratio,t._sizeFactor)));const s=new at(t._id,t._name,e);this._userPalettes.set(s.id,s)}))}static saveUserPalettes(){let t=[];this._userPalettes.forEach((e=>{t.push(e)})),window.localStorage.setItem("userPalettes",JSON.stringify(t))}static setUserPalette(t){this._userPalettes.set(t.id,t),this.saveUserPalettes()}static deleteUserPalette(t){this._userPalettes.delete(t),this.saveUserPalettes()}static getDefaultPalettes(){return this._defaultPalettes}static getUserPalettes(){return this._userPalettes}static getBaseColorFromPalette(t){return(this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors[0].value}static colorGeneratorFromPalette(t){return this.colorGenerator((this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors)}static*colorGenerator(t){let e=t;for(t.length>0&&"string"==typeof t[0]&&(e=e.map((t=>new lt(t))));;){let t=this.range(0,e.length-1);for(let e=t.length;1<e;e--){let s=Math.floor(Math.random()*e);[t[s],t[e-1]]=[t[e-1],t[s]]}for(let s=0;s<t.length;s++){e[t[s]].ratio>Math.random()&&(yield e[t[s]])}}}}function ht(t,e,s){const n=t.slice();return n[33]=e[s],n[34]=e,n[35]=s,n}function ut(t,e,s){const n=t.slice();return n[36]=e[s][0],n[37]=e[s][1],n}function dt(t,e,s){const n=t.slice();return n[36]=e[s][0],n[37]=e[s][1],n}function ft(t){let e,s,i,r,o,a,l,m,_,w,b,P,$,A,M,k,C,E,T,F,S,I,R,B,U,D,G,L,q,O,Y;return{c(){e=d("div"),s=d("div"),s.textContent="Pattern Parameter",i=p(),r=d("div"),o=d("div"),a=f("Number of Points ("),l=d("span"),m=f(t[2]),_=f(")"),w=p(),b=d("div"),P=d("input"),$=p(),A=d("div"),M=d("div"),k=f("Camo Depth ("),C=d("span"),E=f(t[3]),T=f(")"),F=p(),S=d("div"),I=d("input"),R=p(),B=d("div"),U=d("div"),U.textContent="Control",D=p(),G=d("span"),G.textContent="Animate",L=p(),q=d("span"),q.textContent="Mouse Track",x(s,"class","control-section-title svelte-1yxa9sx"),x(l,"id","num-points-val"),x(o,"class","control-section-sub-title svelte-1yxa9sx"),x(P,"type","range"),x(P,"name","num-points"),x(P,"min","1"),x(P,"max","1000"),x(P,"class","svelte-1yxa9sx"),x(r,"class","control-section-sub svelte-1yxa9sx"),x(C,"id","camo-depth-val"),x(M,"class","control-section-sub-title svelte-1yxa9sx"),x(I,"type","range"),x(I,"name","camo-depth"),x(I,"min","1"),x(I,"max","20"),x(I,"class","svelte-1yxa9sx"),x(A,"class","control-section-sub svelte-1yxa9sx"),x(U,"class","control-section-sub-title svelte-1yxa9sx"),x(G,"class","button svelte-1yxa9sx"),x(q,"class","button svelte-1yxa9sx"),x(B,"class","control-section-sub svelte-1yxa9sx"),x(e,"class","control-section svelte-1yxa9sx")},m(n,u){h(n,e,u),c(e,s),c(e,i),c(e,r),c(r,o),c(o,a),c(o,l),c(l,m),c(o,_),c(r,w),c(r,b),c(b,P),v(P,t[2]),c(e,$),c(e,A),c(A,M),c(M,k),c(M,C),c(C,E),c(M,T),c(A,F),c(A,S),c(S,I),v(I,t[3]),c(e,R),c(e,B),c(B,U),c(B,D),c(B,G),c(B,L),c(B,q),O||(Y=[g(P,"change",t[20]),g(P,"input",t[20]),g(I,"change",t[21]),g(I,"input",t[21]),g(G,"mousedown",t[11]),g(q,"mousedown",t[12])],O=!0)},p(t,e){4&e[0]&&y(m,t[2]),4&e[0]&&v(P,t[2]),8&e[0]&&y(E,t[3]),8&e[0]&&v(I,t[3])},d(t){t&&u(e),O=!1,n(Y)}}}function pt(t,e){let s,i,r,o,a,l,m,y,v,w,b=e[37].name+"";return{key:t,first:null,c(){s=d("div"),i=d("label"),r=d("input"),o=p(),a=d("span"),a.innerHTML='<span class="inside svelte-1yxa9sx"></span>',l=p(),m=d("span"),y=f(b),x(r,"type","radio"),r.__value=e[36],r.value=r.__value,x(r,"class","svelte-1yxa9sx"),e[24][0].push(r),x(a,"class","outside svelte-1yxa9sx"),x(m,"class","radio-name"),x(i,"class","radio svelte-1yxa9sx"),_(s,"width","100%"),_(s,"display","flex"),this.first=s},m(t,n){h(t,s,n),c(s,i),c(i,r),r.checked=r.__value===e[0],c(i,o),c(i,a),c(i,l),c(i,m),c(m,y),v||(w=[g(r,"change",e[23]),g(r,"change",e[25])],v=!0)},p(t,s){e=t,1&s[0]&&(r.checked=r.__value===e[0])},d(t){t&&u(s),e[24][0].splice(e[24][0].indexOf(r),1),v=!1,n(w)}}}function gt(t,e){let s,r,o,a,l,m,v,w,b,P,$,A,M,k,C,E,T=e[37].name+"";return{key:t,first:null,c(){s=d("div"),r=d("label"),o=d("input"),l=p(),m=d("span"),m.innerHTML='<span class="inside svelte-1yxa9sx"></span>',v=p(),w=d("span"),b=f(T),P=p(),$=d("span"),$.innerHTML='<i class="fas fa-edit"></i>',A=p(),M=d("span"),M.innerHTML='<i class="far fa-trash-alt"></i>',k=p(),x(o,"type","radio"),o.__value=a=e[36],o.value=o.__value,x(o,"class","svelte-1yxa9sx"),e[24][0].push(o),x(m,"class","outside svelte-1yxa9sx"),x(w,"class","radio-name"),x(r,"class","radio svelte-1yxa9sx"),x($,"class","icon-button svelte-1yxa9sx"),x(M,"class","icon-button svelte-1yxa9sx"),_(s,"width","100%"),_(s,"display","flex"),_(s,"align-items","center"),this.first=s},m(t,n){h(t,s,n),c(s,r),c(r,o),o.checked=o.__value===e[0],c(r,l),c(r,m),c(r,v),c(r,w),c(w,b),c(s,P),c(s,$),c(s,A),c(s,M),c(s,k),C||(E=[g(o,"change",e[26]),g(o,"change",e[27]),g($,"click",(function(){i(e[18](e[37]))&&e[18](e[37]).apply(this,arguments)})),g(M,"click",(function(){i(e[19](e[37]))&&e[19](e[37]).apply(this,arguments)}))],C=!0)},p(t,s){e=t,16&s[0]&&a!==(a=e[36])&&(o.__value=a,o.value=o.__value),1&s[0]&&(o.checked=o.__value===e[0]),16&s[0]&&T!==(T=e[37].name+"")&&y(b,T)},d(t){t&&u(s),e[24][0].splice(e[24][0].indexOf(o),1),C=!1,n(E)}}}function xt(t){let e,s,i,r,o,a,l,m,y,v,_,w,b,P,$,A,M,k,C=[],E=new Map,T=[],F=new Map,S="m90p2"===t[1]&&ft(t),I=[...t[8]];const R=t=>t[36];for(let e=0;e<I.length;e+=1){let s=dt(t,I,e),n=R(s);E.set(n,C[e]=pt(n,s))}let B=[...t[4]];const U=t=>t[36];for(let e=0;e<B.length;e+=1){let s=ut(t,B,e),n=U(s);F.set(n,T[e]=gt(n,s))}return{c(){e=d("div"),s=d("div"),s.textContent="Camo Pattern",i=p(),r=d("div"),o=d("span"),o.textContent="Refresh",a=p(),l=d("span"),l.textContent="Download",m=p(),S&&S.c(),y=p(),v=d("div"),_=d("div"),w=f("Color Palette\n                    "),b=d("span"),b.textContent="+Add",P=p(),$=d("div");for(let t=0;t<C.length;t+=1)C[t].c();A=p();for(let t=0;t<T.length;t+=1)T[t].c();x(s,"class","control-section-title svelte-1yxa9sx"),x(o,"class","button svelte-1yxa9sx"),x(l,"class","button svelte-1yxa9sx"),x(r,"class","control-section-sub svelte-1yxa9sx"),x(e,"class","control-section svelte-1yxa9sx"),x(b,"class","button small svelte-1yxa9sx"),x(_,"class","control-section-title svelte-1yxa9sx"),x($,"class","control-section-sub svelte-1yxa9sx"),x(v,"class","control-section svelte-1yxa9sx")},m(n,u){h(n,e,u),c(e,s),c(e,i),c(e,r),c(r,o),c(r,a),c(r,l),h(n,m,u),S&&S.m(n,u),h(n,y,u),h(n,v,u),c(v,_),c(_,w),c(_,b),c(v,P),c(v,$);for(let t=0;t<C.length;t+=1)C[t].m($,null);c($,A);for(let t=0;t<T.length;t+=1)T[t].m($,null);M||(k=[g(o,"mousedown",t[9]),g(l,"mousedown",t[10]),g(b,"mousedown",t[22])],M=!0)},p(t,e){"m90p2"===t[1]?S?S.p(t,e):(S=ft(t),S.c(),S.m(y.parentNode,y)):S&&(S.d(1),S=null),769&e[0]&&(I=[...t[8]],C=O(C,e,R,1,t,I,E,$,q,pt,A,dt)),786961&e[0]&&(B=[...t[4]],T=O(T,e,U,1,t,B,F,$,q,gt,null,ut))},d(t){t&&u(e),t&&u(m),S&&S.d(t),t&&u(y),t&&u(v);for(let t=0;t<C.length;t+=1)C[t].d();for(let t=0;t<T.length;t+=1)T[t].d();M=!1,n(k)}}}function mt(t){let e,s;return e=new K({props:{$$slots:{default:[vt]},$$scope:{ctx:t}}}),{c(){j(e.$$.fragment)},m(t,n){z(e,t,n),s=!0},p(t,s){const n={};224&s[0]|2048&s[1]&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){s||(G(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){H(e,t)}}}function yt(t,e){let s,r,o,a,l,f,m,y;function w(){e[29].call(o,e[34],e[35])}return{key:t,first:null,c(){s=d("div"),r=d("label"),o=d("input"),a=p(),l=d("span"),l.innerHTML='<i class="far fa-trash-alt"></i>',f=p(),x(o,"type","color"),x(o,"class","svelte-1yxa9sx"),x(l,"class","icon-button svelte-1yxa9sx"),x(r,"class","svelte-1yxa9sx"),_(s,"position","relative"),this.first=s},m(t,n){h(t,s,n),c(s,r),c(r,o),v(o,e[33].color),c(r,a),c(r,l),c(s,f),m||(y=[g(o,"input",w),g(o,"input",e[15]),g(l,"click",(function(){i(e[16](e[35]))&&e[16](e[35]).apply(this,arguments)}))],m=!0)},p(t,s){e=t,64&s[0]&&v(o,e[33].color)},d(t){t&&u(s),m=!1,n(y)}}}function vt(t){let e,s,i,r,o,a,l,m,y,w,b,P,$,A,M,k,C,E,T,F,S,I,R,B,U=[],D=new Map,G=t[6];const L=t=>t[35];for(let e=0;e<G.length;e+=1){let s=ht(t,G,e),n=L(s);D.set(n,U[e]=yt(n,s))}return{c(){e=d("div"),s=d("div"),s.textContent="Edit Color Palette",i=p(),r=d("span"),r.textContent="X Close",o=p(),a=d("div"),l=p(),m=d("div"),y=d("div"),y.textContent="Colors",w=p(),b=d("span"),b.textContent="Add Color",P=p();for(let t=0;t<U.length;t+=1)U[t].c();$=p(),A=d("div"),M=d("div"),M.textContent="Palette Name",k=p(),C=d("input"),E=p(),T=d("div"),F=d("button"),S=f("Save Color Palette"),x(s,"class","control-section-title svelte-1yxa9sx"),_(s,"float","left"),x(r,"class","button small svelte-1yxa9sx"),_(r,"float","right"),_(a,"clear","both"),x(y,"class","control-section-sub-title svelte-1yxa9sx"),x(b,"class","button full small svelte-1yxa9sx"),x(m,"class","control-section-sub svelte-1yxa9sx"),x(M,"class","control-section-sub-title svelte-1yxa9sx"),x(C,"type","text"),x(C,"class","svelte-1yxa9sx"),x(A,"class","control-section-sub svelte-1yxa9sx"),x(F,"class","button full svelte-1yxa9sx"),F.disabled=I=t[6].length<2||t[7]&&0===t[7].length,x(T,"class","control-section-sub svelte-1yxa9sx"),_(T,"margin-top","1rem"),x(e,"class","control-section svelte-1yxa9sx")},m(n,u){h(n,e,u),c(e,s),c(e,i),c(e,r),c(e,o),c(e,a),c(e,l),c(e,m),c(m,y),c(m,w),c(m,b),c(m,P);for(let t=0;t<U.length;t+=1)U[t].m(m,null);c(e,$),c(e,A),c(A,M),c(A,k),c(A,C),v(C,t[7]),c(e,E),c(e,T),c(T,F),c(F,S),R||(B=[g(r,"mousedown",t[28]),g(b,"click",t[14]),g(C,"input",t[30]),g(F,"click",t[17])],R=!0)},p(t,e){98368&e[0]&&(G=t[6],U=O(U,e,L,1,t,G,D,m,q,yt,null,ht)),128&e[0]&&C.value!==t[7]&&v(C,t[7]),192&e[0]&&I!==(I=t[6].length<2||t[7]&&0===t[7].length)&&(F.disabled=I)},d(t){t&&u(e);for(let t=0;t<U.length;t+=1)U[t].d();R=!1,n(B)}}}function _t(t){let e,s,i,r,o;i=new K({props:{$$slots:{default:[xt]},$$scope:{ctx:t}}});let a=t[5]&&mt(t);return{c(){e=d("div"),s=d("div"),j(i.$$.fragment),r=p(),a&&a.c(),x(s,"class","control-columns svelte-1yxa9sx"),x(e,"class","control-panel svelte-1yxa9sx")},m(t,n){h(t,e,n),c(e,s),z(i,s,null),c(s,r),a&&a.m(s,null),o=!0},p(t,e){const r={};31&e[0]|2048&e[1]&&(r.$$scope={dirty:e,ctx:t}),i.$set(r),t[5]?a?(a.p(t,e),32&e[0]&&G(a,1)):(a=mt(t),a.c(),G(a,1),a.m(s,null)):a&&(D={r:0,c:[],p:D},L(a,1,1,(()=>{a=null})),D.r||n(D.c),D=D.p)},i(t){o||(G(i.$$.fragment,t),G(a),o=!0)},o(t){L(i.$$.fragment,t),L(a),o=!1},d(t){t&&u(e),H(i),a&&a.d()}}}function wt(t,e,s){let n;o(t,ot,(t=>s(32,n=t)));let i,r,{camoPattern:a="m90p2"}=e,{colorPalette:l="green"}=e,c=[...ct.getDefaultPalettes()],h=[...ct.getUserPalettes()],u=!1,d=500,f=2,p=[{color:"#000000"}];function g(){st.update((t=>(t+1)%2))}function x(){s(5,u=!0),s(6,p=[]),s(7,r=void 0),i=void 0,y(!1)}function y(t=!0){s(6,p=p.concat({color:"#"+("0"+Math.floor(16777215*Math.random()).toString(16)).slice(-6)})),t&&v()}function v(){!function(t,e,s=e){t.set(s)}(ot,n=p.map((t=>t.color)),n)}return t.$$set=t=>{"camoPattern"in t&&s(1,a=t.camoPattern),"colorPalette"in t&&s(0,l=t.colorPalette)},t.$$.update=()=>{12&t.$$.dirty[0]&&(tt.set(d),et.set(f))},[l,a,d,f,h,u,p,r,c,g,function(){nt.update((t=>(t+1)%2))},function(){rt.update((t=>!t))},function(){it.update((t=>!t))},x,y,v,function(t){console.log(t),p.splice(t,1),s(6,p=[...p]),v()},function(){s(5,u=!1);let t=i||(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16),e=new at(t,r,p.map((t=>new lt(t.color))));ct.setUserPalette(e),s(4,h=[...ct.getUserPalettes()])},function(t){s(5,u=!0),s(0,l=i=t.id),s(6,p=t.colors.map((t=>({color:t.value})))),s(7,r=t.name)},function(t){window.confirm(`Delete ${t.name}?`)&&(ct.deleteUserPalette(t.id),s(4,h=[...ct.getUserPalettes()]))},function(){d=m(this.value),s(2,d)},function(){f=m(this.value),s(3,f)},()=>x(),function(){l=this.__value,s(0,l)},[[]],()=>g(),function(){l=this.__value,s(0,l)},()=>g(),()=>s(5,u=!1),function(t,e){t[e].color=this.value,s(6,p)},function(){r=this.value,s(7,r)}]}ct.ctor=(ct.loadDefaultPalettes(),ct.loadUserPalettes(),null),ct.range=(t,e)=>Array.from({length:e-t+1},((e,s)=>s+t));class bt extends W{constructor(t){super(),X(this,t,wt,_t,r,{camoPattern:1,colorPalette:0},[-1,-1])}}class Pt{constructor(t,e,s=null){this._x=t,this._y=e,this._index=s}get coord(){return[this._x,this._y]}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get key(){return`${this.x},${this.y}`}get hasIndex(){return!!this._index}get keyIndex(){return this._index}get vec(){return[this.x,this.y]}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y}div(t){return this.x/=t,this.y/=t,this}static of(t,e){let s=`${t},${e}`;return void 0===this._cache[s]&&(this._cache[s]=new Pt(t,e)),this._cache[s]}static randomOf(t=0,e=0,s,n){return Pt.of(t+Math.random()*s,e+Math.random()*n)}static randomPointsOf(t,e,s,n){let i=[];for(let t=0;t<n;t++)i.push(2*Math.PI*Math.random());return i.sort(),i.map((n=>Pt.of(t+s*Math.cos(n),e+s*Math.sin(n))))}static randomPoints2Of(t,e,s,n){let i=[],r=2*Math.PI*Math.random();for(let t=0;t<n;t++){let e=1.5*Math.random()-.75,s=2*Math.PI/n*t+e;i.push(s+r)}return i.sort(),i.map((n=>Pt.of(t+s*Math.cos(n),e+s*Math.sin(n))))}}Pt._cache={};class $t{}$t.range=(t,e)=>Array.from({length:e-t+1},((e,s)=>s+t));class At{constructor(t,e,s){this._center=t,this._radius=e,this._color=s}get center(){return this._center}get radius(){return this._radius}get color(){return this._color}isContaining(t){return this.center.dist(t)<this.radius}}class Mt{constructor(t,e){t.hasIndex&&e.hasIndex?t.keyIndex<e.keyIndex?(this._start=t,this._end=e):(this._start=e,this._end=t):t.x<=e.x?(this._start=t,this._end=e):(this._start=e,this._end=t)}get start(){return this._start}get end(){return this._end}get key(){return`${this.start.key}/${this.end.key}`}get keyIndex(){return`${this.start.keyIndex}-${this.end.keyIndex}`}equals(t){return this._start.equals(t._start)&&this._end.equals(t._end)||this._start.equals(t._end)&&this._end.equals(t._start)}}class kt extends class{constructor(t,e,s,n=[]){this._points=t,this._color=e,this._strokeColor=s,this._colors=n,this._center=this._points.reduce(((t,e,s,n)=>new Pt(t.x+e.x,t.y+e.y))).div(this._points.length),this._points.sort(this.comparePoints.bind(this)),this.setMinMax()}get points(){return this._points}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get key(){return this.points.map((t=>t.key)).join("/")}get keyIndex(){return this.points.map((t=>t.keyIndex.toString())).join("/")}equals(t){if(this.points.length!=t.points.length)return!1;for(let e=0;e<this.points.length;e++)if(!this.points[e].equals(t.points[e]))return!1;return!0}isContaining(t){let e=!1;if(t.x<this.minX||t.x>this.maxX||t.y<this.minY||t.y>this.maxY)return!1;for(let s=0,n=this.points.length-1;s<this.points.length;n=s++)this.points[s].y>t.y!=this.points[n].y>t.y&&t.x<(this.points[n].x-this.points[s].x)*(t.y-this.points[s].y)/(this.points[n].y-this.points[s].y)+this.points[s].x&&(e=!e);return e}setMinMax(){this.minX=this.points[0].x,this.maxX=this.points[0].x,this.minY=this.points[0].y,this.maxY=this.points[0].y;for(let t=1;t<this.points.length;t++){let e=this.points[t];this.minX=Math.min(e.x,this.minX),this.maxX=Math.max(e.x,this.maxX),this.minY=Math.min(e.y,this.minY),this.maxY=Math.max(e.y,this.maxY)}}comparePoints(t,e){if(t.equals(e))return 0;return(()=>{if(t.x-this._center.x>=0&&e.x-this._center.x<0)return!0;if(t.x-this._center.x<0&&e.x-this._center.x>=0)return!1;if(t.x-this._center.x==0&&e.x-this._center.x==0)return t.y-this._center.y>=0||e.y-this._center.y>=0?t.y>e.y:e.y>t.y;let s=(t.x-this._center.x)*(e.y-this._center.y)-(e.x-this._center.x)*(t.y-this._center.y);return s<0||!(s>0)&&(t.x-this._center.x)*(t.x-this._center.x)+(t.y-this._center.y)*(t.y-this._center.y)>(e.x-this._center.x)*(e.x-this._center.x)+(e.y-this._center.y)*(e.y-this._center.y)})()?1:-1}}{constructor(t,e,s=[]){if(3!=t.length)throw Error("Triangle must have 3 points");super(t,e,void 0,s)}get area(){return this._area||(this._area=Math.abs(.5*(this.points[0].x*(this.points[1].y-this.points[2].y)+this.points[1].x*(this.points[2].y-this.points[0].y)+this.points[2].x*(this.points[0].y-this.points[1].y)))),this._area}get edges(){return this._edges||(this._edges=[],this._edges.push(new Mt(this.points[0],this.points[1])),this._edges.push(new Mt(this.points[1],this.points[2])),this._edges.push(new Mt(this.points[2],this.points[0]))),this._edges}getCircumcircle(){if(!this._circumcircle){const t=this.points[0].x,e=this.points[0].y,s=this.points[1].x,n=this.points[1].y,i=this.points[2].x,r=this.points[2].y,o=Math.pow(t,2),a=Math.pow(s,2),l=Math.pow(i,2),c=Math.pow(e,2),h=Math.pow(n,2),u=Math.pow(r,2),d=2*((s-t)*(r-e)-(n-e)*(i-t)),f=((r-e)*(a-o+h-c)+(e-n)*(l-o+u-c))/d,p=((t-i)*(a-o+h-c)+(s-t)*(l-o+u-c))/d,g=Math.sqrt(Math.pow(t-f,2)+Math.pow(e-p,2));this._circumcircle=new At(new Pt(f,p),g,"white")}return this._circumcircle}}class Ct{static incrementAndGet(){return void 0===this._index&&(this._index=0),this._index++}static reset(){this._index=0}}class Et{constructor(t){this.ctx=t}drawPolygon(t,e,s){e?(this.ctx.fillStyle=e,this.ctx.strokeStyle=s||e):(this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.strokeColor||t.color),this.ctx.beginPath(),t.points.forEach(((t,e)=>{0===e?this.ctx.moveTo(...t.coord):this.ctx.lineTo(...t.coord)})),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill()}clearCanvas(){}}class Tt extends class{constructor(t){this.ctx=t}drawPolygon(t,e,s){e?(this.ctx.fillStyle=e,this.ctx.strokeStyle=s||e):(this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.strokeColor||t.color),this.ctx.beginPath(),t.points.forEach(((t,e)=>{0===e?this.ctx.moveTo(...t.coord):this.ctx.lineTo(...t.coord)})),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill()}}{constructor(t,e){super(t),this.activeTriangle=new Array(2),this.renderer=void 0===e?new Et(t):e}draw(t,e,s,n){let i;this.renderer.clearCanvas(),i=Array.isArray(s)?ct.colorGenerator(s):s,this.points=[];const r=Math.ceil(t/500),o=Math.ceil(e/500);if(n.skipPointGeneration&&this.triangles){this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];if(this.visitMap[e.keyIndex])continue;const s=i.next().value;this.makeCamouflage(e,s,n.camo_depth)}return}Ct.reset();for(let s=0;s<r+1;s++)for(let n=0;n<o+1;n++)this.points.push(new Pt(t/r*s,e/o*n,Ct.incrementAndGet()));let a=n.num_points-1;$t.range(0,a).forEach(((s,n)=>{this.points.push(new Pt(Math.random()*t,Math.random()*e,Ct.incrementAndGet()))}));const l=Math.sqrt(t*t+e*e)/2,c=new Pt(t/2,e/2),h=new Pt(c.x-Math.sqrt(3)*l,c.y-l,Ct.incrementAndGet()),u=new Pt(c.x+Math.sqrt(3)*l,c.y-l,Ct.incrementAndGet()),d=new Pt(c.x,c.y+2*l,Ct.incrementAndGet()),f=new kt([h,u,d],"pink");i.next();let p=[f];this.points.forEach(((t,e)=>{let s=[];p.forEach(((e,n)=>{e.getCircumcircle().isContaining(t)&&(s=s.concat(e.edges),delete p[n])})),s.map(((t,e)=>{for(let n=0;n<s.length;n++)if(e!=n&&t.equals(s[n]))return null;return t})).filter((t=>t)).forEach((e=>{p.push(new kt([e.start,e.end,t],i.next().value.value))}))})),this.triangles=p.filter((t=>t)),this.triangleAreas=this.triangles.map((t=>t.area)).sort(((t,e)=>t-e)),this.triangleAreaMedian=this.triangleAreas[Math.floor(this.triangleAreas.length/2)],this.buildEdgeMap(),this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];if(this.visitMap[e.keyIndex])continue;const s=i.next().value;this.makeCamouflage(e,s,Math.ceil(n.camo_depth*s.sizeFactor))}}makeCamouflage(t,e,s,n=null){if(n=n||s,t.color=e.value,this.visitMap[t.keyIndex]=e.value,0==s)return void this.renderer.drawPolygon(t,e.value);let i=s===n,r=[];t.edges.forEach(((o,a)=>{const l=this.edgeMap[o.keyIndex].filter((e=>!e.equals(t)))[0];l&&r.push(l),l&&!this.visitMap[l.keyIndex]&&(i=!1,(l.area<5e3||Math.random()<s/n)&&this.makeCamouflage(l,e,s-1,n))})),i?0==r.length?console.error("Failed to find adjacentTriangle"):(t.color=this.visitMap[r[0].keyIndex],this.renderer.drawPolygon(t,t.color,t.color)):this.renderer.drawPolygon(t,e.value)}startAnimate(){this.interval=setInterval(this.animate.bind(this),50)}stopAnimate(){clearInterval(this.interval)}animate(){this.points.forEach(((t,e)=>{this.points[e].x+=4*(Math.random()-.5),this.points[e].y+=4*(Math.random()-.5)})),this.triangles.forEach((t=>{this.isActiveTriangle(t)?this.renderer.drawPolygon(t,"#FF0000"):this.adjacentPolygons&&this.adjacentPolygons[t.keyIndex]?this.renderer.drawPolygon(t,"#0000FF"):this.renderer.drawPolygon(t)}))}handleMouseMove(t){this.triangles.forEach((e=>{e.isContaining(t)?(this.updateActiveTriangle(e),this.renderer.drawPolygon(e,"#FF0000")):this.renderer.drawPolygon(e)})),Object.keys(this.adjacentPolygons).forEach((t=>{this.renderer.drawPolygon(this.adjacentPolygons[t],"#0000FF")}))}buildEdgeMap(){this.edgeMap={},this.triangles.forEach((t=>{t.edges.forEach((e=>{void 0===this.edgeMap[e.keyIndex]&&(this.edgeMap[e.keyIndex]=[]),this.edgeMap[e.keyIndex].push(t)}))}))}updateActiveTriangle(t){if(!this.isActiveTriangle(t)){this.activeTriangle[1]=this.activeTriangle[0],this.activeTriangle[0]=t,this.adjacentPolygons={};for(let e=0;e<t.edges.length;e++){const s=this.edgeMap[t.edges[e].keyIndex];s&&s.length>1&&s.forEach((e=>{e.equals(t)||(this.adjacentPolygons[e.keyIndex]=e)}))}}}isActiveTriangle(t){return this.activeTriangle[0]&&this.activeTriangle[0].equals(t)}}class Ft{static createShader(t,e,s){let n=t.createShader(e);if(t.shaderSource(n,s),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return n;console.log(t.getShaderInfoLog(n)),t.deleteShader(n)}static createAttribute2f(t,e,s,n){const i=t.getAttribLocation(e,s),r=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),[i,r]}static createAttribute4f(t,e,s,n){const i=t.getAttribLocation(e,s),r=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),[i,r]}static render(t,e,s){}}class St{constructor(t,e,s,n=1){this._r=t,this._g=e,this._b=s,this._a=n}get r(){return this._r}get g(){return this._g}get b(){return this._b}get vec(){return[this._r,this._g,this._b,this._a]}static fromHex(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new St(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))}}class It{constructor(t){this.gl=t,this.configureWebGL()}drawPolygon(t,e,s){const n=t.points.flatMap((s=>null!=e?St.fromHex(e).vec:St.fromHex(t.color).vec));this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexColorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(n),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t.points.flatMap((t=>t.vec))),this.gl.STATIC_DRAW),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,t.points.length)}clearCanvas(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.configureUniform(this.defaultProgram)}configureWebGL(t,e){void 0===t&&(t="attribute vec2 a_position;attribute vec4 a_vertex_color;uniform vec2 u_resolution;varying lowp vec4 v_color;void main(){vec2 zeroToOne=a_position/u_resolution;vec2 zeroToTwo=zeroToOne*2.0;vec2 clipSpace=zeroToTwo-1.0;gl_Position=vec4(clipSpace*vec2(1,-1),0,1);v_color=a_vertex_color;}"),void 0===e&&(e="precision mediump float;varying lowp vec4 v_color;void main(){vec4 normalVec=vec4(255.0,255.0,255.0,1.0);gl_FragColor=v_color/normalVec;}");const s=Ft.createShader(this.gl,this.gl.VERTEX_SHADER,t),n=Ft.createShader(this.gl,this.gl.FRAGMENT_SHADER,e);this.defaultProgram=this.wenGLCreateProgram(s,n),this.gl.useProgram(this.defaultProgram),this.configureUniform(this.defaultProgram),this.configureAttribute(this.defaultProgram),this.clearCanvas()}wenGLCreateProgram(t,e){const s=this.gl.createProgram();this.gl.attachShader(s,t),this.gl.attachShader(s,e),this.gl.linkProgram(s);if(this.gl.getProgramParameter(s,this.gl.LINK_STATUS))return s;this.gl.deleteProgram(s)}configureUniform(t){let e=this.gl.getUniformLocation(t,"u_resolution");this.gl.uniform2f(e,this.gl.canvas.width,this.gl.canvas.height)}configureAttribute(t){const[e,s]=Ft.createAttribute2f(this.gl,t,"a_position",new Float32Array([])),[n,i]=Ft.createAttribute4f(this.gl,t,"a_vertex_color",new Float32Array([]));this.positionBuffer=s,this.vertexColorBuffer=i}}function Rt(e){let s,i,r,o;return{c(){s=d("div"),i=d("canvas"),x(s,"class","canvas-wrapper svelte-pol47w")},m(t,n){h(t,s,n),c(s,i),e[6](i),r||(o=[g(window,"resize",e[5]),g(i,"mousemove",e[2])],r=!0)},p:t,i:t,o:t,d(t){t&&u(s),e[6](null),r=!1,n(o)}}}function Bt(t,e,s){let n,i;o(t,tt,(t=>s(11,n=t))),o(t,et,(t=>s(12,i=t)));let r,a,l,c,{pattern:h="m90p2"}=e,{color:u}=e,d=!1;var f;f=()=>{c=r.getContext("webgl",{preserveDrawingBuffer:!0}),l=new Tt(c,new It(c)),v()},P().$$.on_mount.push(f);const p=st.subscribe((t=>v())),g=it.subscribe((t=>d=t)),x=rt.subscribe((t=>{l&&(t?l.startAnimate():l.stopAnimate())})),m=nt.subscribe((function(){if(!r)return;let t=document.createElement("a");const e=document.createElement("canvas");e.getContext("2d").drawImage(r,0,0),document.body.appendChild(t),t.setAttribute("download","camo-pattern.png"),t.setAttribute("href",r.toDataURL("image/png").replace("image/png","image/octet-stream")),t.click(),document.body.removeChild(t)})),y=ot.subscribe((t=>{v(ct.colorGenerator(t),!0)}));function v(t,e=!1){if(!c)return;let o=document.documentElement.clientWidth*devicePixelRatio,d=document.documentElement.clientHeight*devicePixelRatio;!function(t,e,n){r.setAttribute("width",t.toString()),r.setAttribute("height",e.toString()),s(0,r.style.width=t/devicePixelRatio+"px",r),s(0,r.style.height=e/devicePixelRatio+"px",r)}(o,d),function(t,e,s,r=!1){if(s=s||ct.colorGeneratorFromPalette(u),"m90p1"===h)a.draw(t,e,s);else{if("m90p2"!==h)throw Error(`Unsupported pattern type: ${h}`);{const o={num_points:n,camo_depth:i,skipPointGeneration:r};l.draw(t,e,s,o)}}}(o,d,t,e)}tt.subscribe((t=>v())),et.subscribe((t=>v())),function(t){P().$$.on_destroy.push(t)}((()=>{p(),g(),x(),m(),y()}));return t.$$set=t=>{"pattern"in t&&s(3,h=t.pattern),"color"in t&&s(4,u=t.color)},[r,v,function(t){d&&"m90p2"===h&&l.handleMouseMove(new Pt(t.clientX,t.clientY))},h,u,()=>v(),function(t){A[t?"unshift":"push"]((()=>{r=t,s(0,r)}))}]}class Ut extends W{constructor(t){super(),X(this,t,Bt,Rt,r,{pattern:3,color:4})}}function Dt(t){let e,s,n,i,r,o,a;function l(e){t[2](e)}function f(e){t[3](e)}let g={};return void 0!==t[0]&&(g.camoPattern=t[0]),void 0!==t[1]&&(g.colorPalette=t[1]),s=new bt({props:g}),A.push((()=>Y(s,"camoPattern",l))),A.push((()=>Y(s,"colorPalette",f))),o=new Ut({props:{pattern:t[0],color:t[1]}}),{c(){e=d("main"),j(s.$$.fragment),r=p(),j(o.$$.fragment),x(e,"class","svelte-1t1boz5")},m(t,n){h(t,e,n),z(s,e,null),c(e,r),z(o,e,null),a=!0},p(t,[e]){const r={};!n&&1&e&&(n=!0,r.camoPattern=t[0],F((()=>n=!1))),!i&&2&e&&(i=!0,r.colorPalette=t[1],F((()=>i=!1))),s.$set(r);const a={};1&e&&(a.pattern=t[0]),2&e&&(a.color=t[1]),o.$set(a)},i(t){a||(G(s.$$.fragment,t),G(o.$$.fragment,t),a=!0)},o(t){L(s.$$.fragment,t),L(o.$$.fragment,t),a=!1},d(t){t&&u(e),H(s),H(o)}}}function Gt(t,e,s){let n,i="green";return[n,i,function(t){n=t,s(0,n)},function(t){i=t,s(1,i)}]}return new class extends W{constructor(t){super(),X(this,t,Gt,Dt,r,{})}}({target:document.body,props:{name:"world"}})}();
