var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function l(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function a(t,e,n,s,o,i,r){const a=function(t,e,n,s){if(t[2]&&s){const o=t[2](s(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|o[s];return t}return e.dirty|o}return e.dirty}(e,s,o,i);if(a){const o=l(e,n,s,r);t.p(o,a)}}function c(t,e){t.appendChild(e)}function h(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function _(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}let $;function w(t){$=t}function M(){if(!$)throw new Error("Function called outside component initialization");return $}const P=[],b=[],k=[],C=[],A=Promise.resolve();let E=!1;function I(t){k.push(t)}function T(t){C.push(t)}let S=!1;const q=new Set;function U(){if(!S){S=!0;do{for(let t=0;t<P.length;t+=1){const e=P[t];w(e),j(e.$$)}for(w(null),P.length=0;b.length;)b.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];q.has(e)||(q.add(e),e())}k.length=0}while(P.length);for(;C.length;)C.pop()();E=!1,S=!1,q.clear()}}function j(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const G=new Set;let O;function D(t,e){t&&t.i&&(G.delete(t),t.i(e))}function B(t,e,n,s){if(t&&t.o){if(G.has(t))return;G.add(t),O.c.push((()=>{G.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function X(t,e){t.d(1),e.delete(t.key)}function Y(t,e,n,s,o,i,r,l,a,c,h,u){let d=t.length,f=i.length,p=d;const g={};for(;p--;)g[t[p].key]=p;const m=[],x=new Map,y=new Map;for(p=f;p--;){const t=u(o,i,p),l=n(t);let a=r.get(l);a?s&&a.p(t,e):(a=c(l,t),a.c()),x.set(l,m[p]=a),l in g&&y.set(l,Math.abs(p-g[l]))}const v=new Set,_=new Set;function $(t){D(t,1),t.m(l,h),r.set(t.key,t),h=t.first,f--}for(;d&&f;){const e=m[f-1],n=t[d-1],s=e.key,o=n.key;e===n?(h=e.first,d--,f--):x.has(o)?!r.has(s)||v.has(s)?$(e):_.has(o)?d--:y.get(s)>y.get(o)?(_.add(s),$(e)):(v.add(o),d--):(a(n,r),d--)}for(;d--;){const e=t[d];x.has(e.key)||a(e,r)}for(;f;)$(m[f-1]);return m}function F(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function L(t){t&&t.c()}function N(t,n,i,r){const{fragment:l,on_mount:a,on_destroy:c,after_update:h}=t.$$;l&&l.m(n,i),r||I((()=>{const n=a.map(e).filter(o);c?c.push(...n):s(n),t.$$.on_mount=[]})),h.forEach(I)}function H(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(P.push(t),E||(E=!0,A.then(U)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function z(e,o,i,r,l,a,c=[-1]){const h=$;w(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:o.context||[]),callbacks:n(),dirty:c,skip_bound:!1};let f=!1;if(d.ctx=i?i(e,o.props||{},((t,n,...s)=>{const o=s.length?s[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),f&&R(e,t)),n})):[],d.update(),f=!0,s(d.before_update),d.fragment=!!r&&r(d.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);d.fragment&&d.fragment.l(t),t.forEach(u)}else d.fragment&&d.fragment.c();o.intro&&D(e.$$.fragment),N(e,o.target,o.anchor,o.customElement),U()}w(h)}class J{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function W(t){let e,n;const s=t[1].default,o=function(t,e,n,s){if(t){const o=l(t,e,n,s);return t[0](o)}}(s,t,t[0],null);return{c(){e=d("div"),o&&o.c(),m(e,"class","control-column svelte-cyesi7")},m(t,s){h(t,e,s),o&&o.m(e,null),n=!0},p(t,[e]){o&&o.p&&(!n||1&e)&&a(o,s,t,t[0],e,null,null)},i(t){n||(D(o,t),n=!0)},o(t){B(o,t),n=!1},d(t){t&&u(e),o&&o.d(t)}}}function K(t,e,n){let{$$slots:s={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,s]}class Q extends J{constructor(t){super(),z(this,t,K,W,i,{})}}const V=[];function Z(e,n=t){let s;const o=[];function r(t){if(i(e,t)&&(e=t,s)){const t=!V.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,l=t){const a=[i,l];return o.push(a),1===o.length&&(s=n(r)||t),i(e),()=>{const t=o.indexOf(a);-1!==t&&o.splice(t,1),0===o.length&&(s(),s=null)}}}}const tt=Z(100),et=Z(2),nt=Z(0),st=Z(0),ot=Z(!1),it=Z(!1),rt=Z([]);class lt{constructor(t,e,n){this._id=t,this._name=e,this._colors=n}get id(){return this._id}get name(){return this._name}get colors(){return this._colors}}class at{static loadDefaultPalettes(){at._defaultPalettes=new Map,at._defaultPalettes.set("green",new lt("green","Green",["#6C7C52","#4A4F44","#3B3845","#B2B096"])),at._defaultPalettes.set("desert",new lt("desert","Desert",["#B8A79B","#72625D","#A69887","#6D4C2D"])),at._defaultPalettes.set("uc1",new lt("uc1","UC1",["#C4B9B5","#683A31","#4A5F56"])),at._defaultPalettes.set("uc2",new lt("uc2","UC2",["#262527","#513A3E","#424B50"]))}static loadUserPalettes(){this._userPalettes=new Map;JSON.parse(window.localStorage.getItem("userPalettes")||"[]").forEach((t=>{const e=new lt(t._id,t._name,t._colors);this._userPalettes.set(e.id,e)}))}static saveUserPalettes(){let t=[];this._userPalettes.forEach((e=>{t.push(e)})),window.localStorage.setItem("userPalettes",JSON.stringify(t))}static setUserPalette(t){this._userPalettes.set(t.id,t),this.saveUserPalettes()}static deleteUserPalette(t){this._userPalettes.delete(t),this.saveUserPalettes()}static getDefaultPalettes(){return this._defaultPalettes}static getUserPalettes(){return this._userPalettes}static getBaseColorFromPalette(t){return(this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors[0]}static colorGeneratorFromPalette(t){return this.colorGenerator((this._defaultPalettes.get(t)||this._userPalettes.get(t)).colors)}static*colorGenerator(t){for(;;){let e=this.range(0,t.length-1);for(let t=e.length;1<t;t--){let n=Math.floor(Math.random()*t);[e[n],e[t-1]]=[e[t-1],e[n]]}for(let n=0;n<e.length;n++)yield t[e[n]]}}static*colorGenerator2(t){for(;;){let e=this.range(0,t.length-1);for(let t=e.length;1<t;t--){let n=Math.floor(Math.random()*t);[e[n],e[t-1]]=[e[t-1],e[n]]}for(let n=0;n<e.length;n++)yield[t[e[n]],n]}}}function ct(t,e,n){const s=t.slice();return s[31]=e[n],s[32]=e,s[33]=n,s}function ht(t,e,n){const s=t.slice();return s[34]=e[n][0],s[35]=e[n][1],s}function ut(t,e,n){const s=t.slice();return s[34]=e[n][0],s[35]=e[n][1],s}function dt(t){let e,n,o,i,r,l,a,x,_,$,w,M,P,b,k,C,A,E,I,T,S,q,U,j,G,O,D,B,X,Y,F;return{c(){e=d("div"),n=d("div"),n.textContent="Pattern Parameter",o=p(),i=d("div"),r=d("div"),l=f("Number of Points ("),a=d("span"),x=f(t[2]),_=f(")"),$=p(),w=d("div"),M=d("input"),P=p(),b=d("div"),k=d("div"),C=f("Camo Depth ("),A=d("span"),E=f(t[3]),I=f(")"),T=p(),S=d("div"),q=d("input"),U=p(),j=d("div"),G=d("div"),G.textContent="Control",O=p(),D=d("span"),D.textContent="Animate",B=p(),X=d("span"),X.textContent="Mouse Track",m(n,"class","control-section-title svelte-hul5os"),m(a,"id","num-points-val"),m(r,"class","control-section-sub-title svelte-hul5os"),m(M,"type","range"),m(M,"name","num-points"),m(M,"min","1"),m(M,"max","500"),m(M,"class","svelte-hul5os"),m(i,"class","control-section-sub svelte-hul5os"),m(A,"id","camo-depth-val"),m(k,"class","control-section-sub-title svelte-hul5os"),m(q,"type","range"),m(q,"name","camo-depth"),m(q,"min","1"),m(q,"max","20"),m(q,"class","svelte-hul5os"),m(b,"class","control-section-sub svelte-hul5os"),m(G,"class","control-section-sub-title svelte-hul5os"),m(D,"class","button svelte-hul5os"),m(X,"class","button svelte-hul5os"),m(j,"class","control-section-sub svelte-hul5os"),m(e,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,o),c(e,i),c(i,r),c(r,l),c(r,a),c(a,x),c(r,_),c(i,$),c(i,w),c(w,M),v(M,t[2]),c(e,P),c(e,b),c(b,k),c(k,C),c(k,A),c(A,E),c(k,I),c(b,T),c(b,S),c(S,q),v(q,t[3]),c(e,U),c(e,j),c(j,G),c(j,O),c(j,D),c(j,B),c(j,X),Y||(F=[g(M,"change",t[20]),g(M,"input",t[20]),g(q,"change",t[21]),g(q,"input",t[21]),g(D,"mousedown",t[11]),g(X,"mousedown",t[12])],Y=!0)},p(t,e){4&e[0]&&y(x,t[2]),4&e[0]&&v(M,t[2]),8&e[0]&&y(E,t[3]),8&e[0]&&v(q,t[3])},d(t){t&&u(e),Y=!1,s(F)}}}function ft(t,e){let n,s,o,i,r,l,a,x,y,v,$=e[35].name+"";return{key:t,first:null,c(){n=d("div"),s=d("label"),o=d("input"),i=p(),r=d("span"),r.innerHTML='<span class="inside svelte-hul5os"></span>',l=p(),a=d("span"),x=f($),m(o,"type","radio"),o.__value=e[34],o.value=o.__value,m(o,"class","svelte-hul5os"),e[24][0].push(o),m(r,"class","outside svelte-hul5os"),m(a,"class","radio-name"),m(s,"class","radio svelte-hul5os"),_(n,"width","100%"),_(n,"display","flex"),this.first=n},m(t,u){h(t,n,u),c(n,s),c(s,o),o.checked=o.__value===e[0],c(s,i),c(s,r),c(s,l),c(s,a),c(a,x),y||(v=g(o,"change",e[23]),y=!0)},p(t,n){e=t,1&n[0]&&(o.checked=o.__value===e[0])},d(t){t&&u(n),e[24][0].splice(e[24][0].indexOf(o),1),y=!1,v()}}}function pt(t,e){let n,i,r,l,a,x,v,$,w,M,P,b,k,C,A,E,I=e[35].name+"";return{key:t,first:null,c(){n=d("div"),i=d("label"),r=d("input"),a=p(),x=d("span"),x.innerHTML='<span class="inside svelte-hul5os"></span>',v=p(),$=d("span"),w=f(I),M=p(),P=d("span"),P.innerHTML='<i class="fas fa-edit"></i>',b=p(),k=d("span"),k.innerHTML='<i class="far fa-trash-alt"></i>',C=p(),m(r,"type","radio"),r.__value=l=e[34],r.value=r.__value,m(r,"class","svelte-hul5os"),e[24][0].push(r),m(x,"class","outside svelte-hul5os"),m($,"class","radio-name"),m(i,"class","radio svelte-hul5os"),m(P,"class","icon-button svelte-hul5os"),m(k,"class","icon-button svelte-hul5os"),_(n,"width","100%"),_(n,"display","flex"),_(n,"align-items","center"),this.first=n},m(t,s){h(t,n,s),c(n,i),c(i,r),r.checked=r.__value===e[0],c(i,a),c(i,x),c(i,v),c(i,$),c($,w),c(n,M),c(n,P),c(n,b),c(n,k),c(n,C),A||(E=[g(r,"change",e[25]),g(P,"click",(function(){o(e[18](e[35]))&&e[18](e[35]).apply(this,arguments)})),g(k,"click",(function(){o(e[19](e[35]))&&e[19](e[35]).apply(this,arguments)}))],A=!0)},p(t,n){e=t,16&n[0]&&l!==(l=e[34])&&(r.__value=l,r.value=r.__value),1&n[0]&&(r.checked=r.__value===e[0]),16&n[0]&&I!==(I=e[35].name+"")&&y(w,I)},d(t){t&&u(n),e[24][0].splice(e[24][0].indexOf(r),1),A=!1,s(E)}}}function gt(t){let e,n,o,i,r,l,a,x,y,v,_,$,w,M,P,b,k,C,A=[],E=new Map,I=[],T=new Map,S="m90p2"===t[1]&&dt(t),q=[...t[8]];const U=t=>t[34];for(let e=0;e<q.length;e+=1){let n=ut(t,q,e),s=U(n);E.set(s,A[e]=ft(s,n))}let j=[...t[4]];const G=t=>t[34];for(let e=0;e<j.length;e+=1){let n=ht(t,j,e),s=G(n);T.set(s,I[e]=pt(s,n))}return{c(){e=d("div"),n=d("div"),n.textContent="Camo Pattern",o=p(),i=d("div"),r=d("span"),r.textContent="Refresh",l=p(),a=d("span"),a.textContent="Download",x=p(),S&&S.c(),y=p(),v=d("div"),_=d("div"),$=f("Color Palette\n                    "),w=d("span"),w.textContent="+Add",M=p(),P=d("div");for(let t=0;t<A.length;t+=1)A[t].c();b=p();for(let t=0;t<I.length;t+=1)I[t].c();m(n,"class","control-section-title svelte-hul5os"),m(r,"class","button svelte-hul5os"),m(a,"class","button svelte-hul5os"),m(i,"class","control-section-sub svelte-hul5os"),m(e,"class","control-section svelte-hul5os"),m(w,"class","button small svelte-hul5os"),m(_,"class","control-section-title svelte-hul5os"),m(P,"class","control-section-sub svelte-hul5os"),m(v,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,o),c(e,i),c(i,r),c(i,l),c(i,a),h(s,x,u),S&&S.m(s,u),h(s,y,u),h(s,v,u),c(v,_),c(_,$),c(_,w),c(v,M),c(v,P);for(let t=0;t<A.length;t+=1)A[t].m(P,null);c(P,b);for(let t=0;t<I.length;t+=1)I[t].m(P,null);k||(C=[g(r,"mousedown",t[9]),g(a,"mousedown",t[10]),g(w,"mousedown",t[22])],k=!0)},p(t,e){"m90p2"===t[1]?S?S.p(t,e):(S=dt(t),S.c(),S.m(y.parentNode,y)):S&&(S.d(1),S=null),257&e[0]&&(q=[...t[8]],A=Y(A,e,U,1,t,q,E,P,X,ft,b,ut)),786449&e[0]&&(j=[...t[4]],I=Y(I,e,G,1,t,j,T,P,X,pt,null,ht))},d(t){t&&u(e),t&&u(x),S&&S.d(t),t&&u(y),t&&u(v);for(let t=0;t<A.length;t+=1)A[t].d();for(let t=0;t<I.length;t+=1)I[t].d();k=!1,s(C)}}}function mt(t){let e,n;return e=new Q({props:{$$slots:{default:[yt]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment)},m(t,s){N(e,t,s),n=!0},p(t,n){const s={};224&n[0]|512&n[1]&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function xt(t,e){let n,i,r,l,a,f,x,y;function $(){e[27].call(r,e[32],e[33])}return{key:t,first:null,c(){n=d("div"),i=d("label"),r=d("input"),l=p(),a=d("span"),a.innerHTML='<i class="far fa-trash-alt"></i>',f=p(),m(r,"type","color"),m(r,"class","svelte-hul5os"),m(a,"class","icon-button svelte-hul5os"),m(i,"class","svelte-hul5os"),_(n,"position","relative"),this.first=n},m(t,s){h(t,n,s),c(n,i),c(i,r),v(r,e[31].color),c(i,l),c(i,a),c(n,f),x||(y=[g(r,"input",$),g(r,"input",e[15]),g(a,"click",(function(){o(e[16](e[33]))&&e[16](e[33]).apply(this,arguments)}))],x=!0)},p(t,n){e=t,64&n[0]&&v(r,e[31].color)},d(t){t&&u(n),x=!1,s(y)}}}function yt(t){let e,n,o,i,r,l,a,x,y,$,w,M,P,b,k,C,A,E,I,T,S,q,U,j,G=[],O=new Map,D=t[6];const B=t=>t[33];for(let e=0;e<D.length;e+=1){let n=ct(t,D,e),s=B(n);O.set(s,G[e]=xt(s,n))}return{c(){e=d("div"),n=d("div"),n.textContent="Edit Color Palette",o=p(),i=d("span"),i.textContent="X Close",r=p(),l=d("div"),a=p(),x=d("div"),y=d("div"),y.textContent="Colors",$=p(),w=d("span"),w.textContent="Add Color",M=p();for(let t=0;t<G.length;t+=1)G[t].c();P=p(),b=d("div"),k=d("div"),k.textContent="Palette Name",C=p(),A=d("input"),E=p(),I=d("div"),T=d("button"),S=f("Save Color Palette"),m(n,"class","control-section-title svelte-hul5os"),_(n,"float","left"),m(i,"class","button small svelte-hul5os"),_(i,"float","right"),_(l,"clear","both"),m(y,"class","control-section-sub-title svelte-hul5os"),m(w,"class","button full small svelte-hul5os"),m(x,"class","control-section-sub svelte-hul5os"),m(k,"class","control-section-sub-title svelte-hul5os"),m(A,"type","text"),m(A,"class","svelte-hul5os"),m(b,"class","control-section-sub svelte-hul5os"),m(T,"class","button full svelte-hul5os"),T.disabled=q=t[6].length<2||t[7]&&0===t[7].length,m(I,"class","control-section-sub svelte-hul5os"),_(I,"margin-top","1rem"),m(e,"class","control-section svelte-hul5os")},m(s,u){h(s,e,u),c(e,n),c(e,o),c(e,i),c(e,r),c(e,l),c(e,a),c(e,x),c(x,y),c(x,$),c(x,w),c(x,M);for(let t=0;t<G.length;t+=1)G[t].m(x,null);c(e,P),c(e,b),c(b,k),c(b,C),c(b,A),v(A,t[7]),c(e,E),c(e,I),c(I,T),c(T,S),U||(j=[g(i,"mousedown",t[26]),g(w,"click",t[14]),g(A,"input",t[28]),g(T,"click",t[17])],U=!0)},p(t,e){98368&e[0]&&(D=t[6],G=Y(G,e,B,1,t,D,O,x,X,xt,null,ct)),128&e[0]&&A.value!==t[7]&&v(A,t[7]),192&e[0]&&q!==(q=t[6].length<2||t[7]&&0===t[7].length)&&(T.disabled=q)},d(t){t&&u(e);for(let t=0;t<G.length;t+=1)G[t].d();U=!1,s(j)}}}function vt(t){let e,n,o,i,r;o=new Q({props:{$$slots:{default:[gt]},$$scope:{ctx:t}}});let l=t[5]&&mt(t);return{c(){e=d("div"),n=d("div"),L(o.$$.fragment),i=p(),l&&l.c(),m(n,"class","control-columns svelte-hul5os"),m(e,"class","control-panel svelte-hul5os")},m(t,s){h(t,e,s),c(e,n),N(o,n,null),c(n,i),l&&l.m(n,null),r=!0},p(t,e){const i={};31&e[0]|512&e[1]&&(i.$$scope={dirty:e,ctx:t}),o.$set(i),t[5]?l?(l.p(t,e),32&e[0]&&D(l,1)):(l=mt(t),l.c(),D(l,1),l.m(n,null)):l&&(O={r:0,c:[],p:O},B(l,1,1,(()=>{l=null})),O.r||s(O.c),O=O.p)},i(t){r||(D(o.$$.fragment,t),D(l),r=!0)},o(t){B(o.$$.fragment,t),B(l),r=!1},d(t){t&&u(e),H(o),l&&l.d()}}}function _t(t,e,n){let s;r(t,rt,(t=>n(30,s=t)));let o,i,{camoPattern:l="m90p2"}=e,{colorPalette:a="green"}=e,c=[...at.getDefaultPalettes()],h=[...at.getUserPalettes()],u=!1,d=100,f=2,p=[{color:"#000000"}];function g(){n(5,u=!0),n(6,p=[]),n(7,i=void 0),o=void 0,m(!1)}function m(t=!0){n(6,p=p.concat({color:"#"+Math.floor(16777215*Math.random()).toString(16)})),t&&y()}function y(){!function(t,e,n=e){t.set(n)}(rt,s=p.map((t=>t.color)),s)}return t.$$set=t=>{"camoPattern"in t&&n(1,l=t.camoPattern),"colorPalette"in t&&n(0,a=t.colorPalette)},t.$$.update=()=>{12&t.$$.dirty[0]&&(tt.set(d),et.set(f))},[a,l,d,f,h,u,p,i,c,function(){nt.update((t=>(t+1)%2))},function(){st.update((t=>(t+1)%2))},function(){it.update((t=>!t))},function(){ot.update((t=>!t))},g,m,y,function(t){console.log(t),p.splice(t,1),n(6,p=[...p]),y()},function(){n(5,u=!1);let t=o||(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16),e=new lt(t,i,p.map((t=>t.color)));at.setUserPalette(e),n(4,h=[...at.getUserPalettes()])},function(t){n(5,u=!0),n(0,a=o=t.id),n(6,p=t.colors.map((t=>({color:t})))),n(7,i=t.name)},function(t){window.confirm(`Delete ${t.name}?`)&&(at.deleteUserPalette(t.id),n(4,h=[...at.getUserPalettes()]))},function(){d=x(this.value),n(2,d)},function(){f=x(this.value),n(3,f)},()=>g(),function(){a=this.__value,n(0,a)},[[]],function(){a=this.__value,n(0,a)},()=>n(5,u=!1),function(t,e){t[e].color=this.value,n(6,p)},function(){i=this.value,n(7,i)}]}at.ctor=(at.loadDefaultPalettes(),void at.loadUserPalettes()),at.range=(t,e)=>Array.from({length:e-t+1},((e,n)=>n+t));class $t extends J{constructor(t){super(),z(this,t,_t,vt,i,{camoPattern:1,colorPalette:0},[-1,-1])}}class wt{constructor(t){this.ctx=t}drawCircle(t){this.ctx.fillStyle=t.color,this.ctx.beginPath(),this.ctx.arc(t.center.x,t.center.y,t.radius,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()}drawPolygon(t,e,n){e?(this.ctx.fillStyle=e,this.ctx.strokeStyle=n||e):(this.ctx.fillStyle=t.color,this.ctx.strokeStyle=t.strokeColor||t.color),this.ctx.beginPath(),t.points.forEach(((t,e)=>{0===e?this.ctx.moveTo(...t.coord):this.ctx.lineTo(...t.coord)})),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill()}}class Mt{constructor(t,e,n=null){this._x=t,this._y=e,this._index=n}get coord(){return[this._x,this._y]}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get key(){return`${this.x},${this.y}`}get hasIndex(){return!!this._index}get keyIndex(){return this._index}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y}div(t){return this.x/=t,this.y/=t,this}static of(t,e){let n=`${t},${e}`;return void 0===this._cache[n]&&(this._cache[n]=new Mt(t,e)),this._cache[n]}static randomOf(t=0,e=0,n,s){return Mt.of(t+Math.random()*n,e+Math.random()*s)}static randomPointsOf(t,e,n,s){let o=[];for(let t=0;t<s;t++)o.push(2*Math.PI*Math.random());return o.sort(),o.map((s=>Mt.of(t+n*Math.cos(s),e+n*Math.sin(s))))}static randomPoints2Of(t,e,n,s){let o=[],i=2*Math.PI*Math.random();for(let t=0;t<s;t++){let e=1.5*Math.random()-.75,n=2*Math.PI/s*t+e;o.push(n+i)}return o.sort(),o.map((s=>Mt.of(t+n*Math.cos(s),e+n*Math.sin(s))))}}Mt._cache={};class Pt{constructor(t,e,n){this._points=t,this._color=e,this._strokeColor=n,this._center=this._points.reduce(((t,e,n,s)=>new Mt(t.x+e.x,t.y+e.y))).div(this._points.length),this._points.sort(this.comparePoints.bind(this)),this.setMinMax()}get points(){return this._points}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get key(){return this.points.map((t=>t.key)).join("/")}get keyIndex(){return this.points.map((t=>t.keyIndex.toString())).join("/")}equals(t){if(this.points.length!=t.points.length)return!1;for(let e=0;e<this.points.length;e++)if(!this.points[e].equals(t.points[e]))return!1;return!0}isContaining(t){let e=!1;if(t.x<this.minX||t.x>this.maxX||t.y<this.minY||t.y>this.maxY)return!1;for(let n=0,s=this.points.length-1;n<this.points.length;s=n++)this.points[n].y>t.y!=this.points[s].y>t.y&&t.x<(this.points[s].x-this.points[n].x)*(t.y-this.points[n].y)/(this.points[s].y-this.points[n].y)+this.points[n].x&&(e=!e);return e}setMinMax(){this.minX=this.points[0].x,this.maxX=this.points[0].x,this.minY=this.points[0].y,this.maxY=this.points[0].y;for(let t=1;t<this.points.length;t++){let e=this.points[t];this.minX=Math.min(e.x,this.minX),this.maxX=Math.max(e.x,this.maxX),this.minY=Math.min(e.y,this.minY),this.maxY=Math.max(e.y,this.maxY)}}comparePoints(t,e){if(t.equals(e))return 0;return(()=>{if(t.x-this._center.x>=0&&e.x-this._center.x<0)return!0;if(t.x-this._center.x<0&&e.x-this._center.x>=0)return!1;if(t.x-this._center.x==0&&e.x-this._center.x==0)return t.y-this._center.y>=0||e.y-this._center.y>=0?t.y>e.y:e.y>t.y;let n=(t.x-this._center.x)*(e.y-this._center.y)-(e.x-this._center.x)*(t.y-this._center.y);return n<0||!(n>0)&&(t.x-this._center.x)*(t.x-this._center.x)+(t.y-this._center.y)*(t.y-this._center.y)>(e.x-this._center.x)*(e.x-this._center.x)+(e.y-this._center.y)*(e.y-this._center.y)})()?1:-1}}class bt extends wt{startAnimate(){}stopAnimate(){}handleMouseMove(t){}draw(t,e,n){const s=500;let o=Math.ceil(t/s),i=Math.ceil(e/s);for(let t=0;t<o;t++)for(let e=0;e<i;e++){let o=s*t,i=s*e,r=n.next(),l=4,a=Math.random();if(a>.66?l=5:a>.33&&(l=6),Math.random()>.8)continue;let c=new Pt(Mt.randomPoints2Of(o,i,s,l),r.value);this.drawPolygon(c)}const r=200;o=Math.ceil(t/r),i=Math.ceil(e/r);for(let t=0;t<o;t++)for(let e=0;e<i;e++){let s=r*t,o=r*e,i=n.next(),l=4,a=Math.random();if(a>.66?l=5:a>.33&&(l=6),Math.random()>.8)continue;let c=new Pt(Mt.randomPoints2Of(s,o,r,l),i.value);this.drawPolygon(c)}}}class kt{constructor(t,e,n){this._center=t,this._radius=e,this._color=n}get center(){return this._center}get radius(){return this._radius}get color(){return this._color}isContaining(t){return this.center.dist(t)<this.radius}}class Ct{}Ct.range=(t,e)=>Array.from({length:e-t+1},((e,n)=>n+t));class At{constructor(t,e){t.hasIndex&&e.hasIndex?t.keyIndex<e.keyIndex?(this._start=t,this._end=e):(this._start=e,this._end=t):t.x<=e.x?(this._start=t,this._end=e):(this._start=e,this._end=t)}get start(){return this._start}get end(){return this._end}get key(){return`${this.start.key}/${this.end.key}`}get keyIndex(){return`${this.start.keyIndex}-${this.end.keyIndex}`}equals(t){return this._start.equals(t._start)&&this._end.equals(t._end)||this._start.equals(t._end)&&this._end.equals(t._start)}}class Et extends Pt{constructor(t,e){if(3!=t.length)throw Error("Triangle must have 3 points");super(t,e)}get area(){return this._area||(this._area=Math.abs(.5*(this.points[0].x*(this.points[1].y-this.points[2].y)+this.points[1].x*(this.points[2].y-this.points[0].y)+this.points[2].x*(this.points[0].y-this.points[1].y)))),this._area}get edges(){return this._edges||(this._edges=[],this._edges.push(new At(this.points[0],this.points[1])),this._edges.push(new At(this.points[1],this.points[2])),this._edges.push(new At(this.points[2],this.points[0]))),this._edges}getCircumcircle(){if(!this._circumcircle){const t=this.points[0].x,e=this.points[0].y,n=this.points[1].x,s=this.points[1].y,o=this.points[2].x,i=this.points[2].y,r=Math.pow(t,2),l=Math.pow(n,2),a=Math.pow(o,2),c=Math.pow(e,2),h=Math.pow(s,2),u=Math.pow(i,2),d=2*((n-t)*(i-e)-(s-e)*(o-t)),f=((i-e)*(l-r+h-c)+(e-s)*(a-r+u-c))/d,p=((t-o)*(l-r+h-c)+(n-t)*(a-r+u-c))/d,g=Math.sqrt(Math.pow(t-f,2)+Math.pow(e-p,2));this._circumcircle=new kt(new Mt(f,p),g,"white")}return this._circumcircle}}class It{static incrementAndGet(){return void 0===this._index&&(this._index=0),this._index++}static reset(){this._index=0}}class Tt extends wt{constructor(t){super(t),this.activeTriangle=new Array(2)}draw(t,e,n,s){this.points=[];const o=Math.ceil(t/500),i=Math.ceil(e/500);if(s.skipPointGeneration&&this.triangles){this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];this.visitMap[e.keyIndex]||this.makeCamouflage(e,n.next().value,s.camo_depth)}return}It.reset();for(let n=0;n<o+1;n++)for(let s=0;s<i+1;s++)this.points.push(new Mt(t/o*n,e/i*s,It.incrementAndGet()));let r=s.num_points-1;Ct.range(0,r).forEach(((n,s)=>{this.points.push(new Mt(Math.random()*t,Math.random()*e,It.incrementAndGet()))}));const l=Math.sqrt(t*t+e*e)/2,a=new Mt(t/2,e/2);this.drawCircle(new kt(a,l,"rgba(1, 1, 1, 0)"));const c=new Mt(a.x-Math.sqrt(3)*l,a.y-l,It.incrementAndGet()),h=new Mt(a.x+Math.sqrt(3)*l,a.y-l,It.incrementAndGet()),u=new Mt(a.x,a.y+2*l,It.incrementAndGet()),d=new Et([c,h,u],"pink");n.next();let f=[d];this.points.forEach(((t,e)=>{let s=[];f.forEach(((e,n)=>{e.getCircumcircle().isContaining(t)&&(s=s.concat(e.edges),delete f[n])})),s.map(((t,e)=>{for(let n=0;n<s.length;n++)if(e!=n&&t.equals(s[n]))return null;return t})).filter((t=>t)).forEach((e=>{f.push(new Et([e.start,e.end,t],n.next().value))}))})),this.triangles=f.filter((t=>t)),this.triangleAreas=this.triangles.map((t=>t.area)).sort(((t,e)=>t-e)),this.triangleAreaMedian=this.triangleAreas[Math.floor(this.triangleAreas.length/2)],this.buildEdgeMap(),this.visitMap={};for(let t=0;t<this.triangles.length;t++){const e=this.triangles[t];this.visitMap[e.keyIndex]||this.makeCamouflage(e,n.next().value,s.camo_depth)}}makeCamouflage(t,e,n,s=null){if(s=s||n,t.color=e,this.visitMap[t.keyIndex]=e,0==n)return void this.drawPolygon(t,e);let o=n===s,i=[];t.edges.forEach(((r,l)=>{const a=this.edgeMap[r.keyIndex].filter((e=>!e.equals(t)))[0];a&&i.push(a),a&&!this.visitMap[a.keyIndex]&&(o=!1,(a.area<5e3||Math.random()<n/s)&&this.makeCamouflage(a,e,n-1,s))})),o?0==i.length?console.error("Failed to find adjacentTriangle"):(t.color=this.visitMap[i[0].keyIndex],this.drawPolygon(t,t.color,t.color)):this.drawPolygon(t,e)}startAnimate(){this.interval=setInterval(this.animate.bind(this),50)}stopAnimate(){clearInterval(this.interval)}animate(){this.points.forEach(((t,e)=>{this.points[e].x+=4*(Math.random()-.5),this.points[e].y+=4*(Math.random()-.5)})),this.triangles.forEach((t=>{this.isActiveTriangle(t)?this.drawPolygon(t,"red"):this.adjacentPolygons&&this.adjacentPolygons[t.keyIndex]?this.drawPolygon(t,"blue"):this.drawPolygon(t)}))}handleMouseMove(t){this.triangles.forEach((e=>{e.isContaining(t)?(this.updateActiveTriangle(e),this.drawPolygon(e,"red")):this.drawPolygon(e)})),Object.keys(this.adjacentPolygons).forEach((t=>{this.drawPolygon(this.adjacentPolygons[t],"blue")}))}buildEdgeMap(){this.edgeMap={},this.triangles.forEach((t=>{t.edges.forEach((e=>{void 0===this.edgeMap[e.keyIndex]&&(this.edgeMap[e.keyIndex]=[]),this.edgeMap[e.keyIndex].push(t)})),this.drawPolygon(t)}))}updateActiveTriangle(t){if(!this.isActiveTriangle(t)){this.activeTriangle[1]=this.activeTriangle[0],this.activeTriangle[0]=t,this.adjacentPolygons={};for(let e=0;e<t.edges.length;e++){const n=this.edgeMap[t.edges[e].keyIndex];n&&n.length>1&&n.forEach((e=>{e.equals(t)||(this.adjacentPolygons[e.keyIndex]=e)}))}}}isActiveTriangle(t){return this.activeTriangle[0]&&this.activeTriangle[0].equals(t)}}function St(e){let n,o,i,r;return{c(){n=d("div"),o=d("canvas"),m(n,"class","canvas-wrapper svelte-pol47w")},m(t,s){h(t,n,s),c(n,o),e[6](o),i||(r=[g(window,"resize",e[5]),g(o,"mousemove",e[2])],i=!0)},p:t,i:t,o:t,d(t){t&&u(n),e[6](null),i=!1,s(r)}}}function qt(t,e,n){let s,o;r(t,tt,(t=>n(11,s=t))),r(t,et,(t=>n(12,o=t)));let i,l,a,c,{pattern:h="m90p2"}=e,{color:u}=e,d=!1;var f;f=()=>{c=i.getContext("2d"),l=new bt(c),a=new Tt(c),v()},M().$$.on_mount.push(f);const p=nt.subscribe((t=>v())),g=ot.subscribe((t=>d=t)),m=it.subscribe((t=>{a&&(t?a.startAnimate():a.stopAnimate())})),x=st.subscribe((function(){if(!i)return;let t=document.createElement("a");document.body.appendChild(t),t.setAttribute("download","camo-pattern.png"),t.setAttribute("href",i.toDataURL("image/png").replace("image/png","image/octet-stream")),t.click(),document.body.removeChild(t)})),y=rt.subscribe((t=>{v(at.colorGenerator(t),!0)}));function v(t,e=!1){if(!c)return;let n=document.documentElement.clientWidth,r=document.documentElement.clientHeight;!function(t,e,n){i.setAttribute("width",t.toString()),i.setAttribute("height",e.toString()),c.fillStyle=n?n.next().value:at.getBaseColorFromPalette(u),c.fillRect(0,0,t,e)}(n,r,t),function(t,e,n,i=!1){if(n=n||at.colorGeneratorFromPalette(u),"m90p1"===h)l.draw(t,e,n);else{if("m90p2"!==h)throw Error(`Unsupported pattern type: ${h}`);{const r={num_points:s,camo_depth:o,skipPointGeneration:i};a.draw(t,e,n,r)}}}(n,r,t,e)}!function(t){M().$$.before_update.push(t)}((()=>v())),function(t){M().$$.on_destroy.push(t)}((()=>{p(),g(),m(),x(),y()}));return t.$$set=t=>{"pattern"in t&&n(3,h=t.pattern),"color"in t&&n(4,u=t.color)},[i,v,function(t){d&&"m90p2"===h&&a.handleMouseMove(new Mt(t.clientX,t.clientY))},h,u,()=>v(),function(t){b[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}class Ut extends J{constructor(t){super(),z(this,t,qt,St,i,{pattern:3,color:4})}}function jt(t){let e,n,s,o,i,r,l;function a(e){t[3](e)}function f(e){t[4](e)}let g={};return void 0!==t[0]&&(g.camoPattern=t[0]),void 0!==t[1]&&(g.colorPalette=t[1]),n=new $t({props:g}),b.push((()=>F(n,"camoPattern",a))),b.push((()=>F(n,"colorPalette",f))),r=new Ut({props:{pattern:t[0],color:t[1]}}),{c(){e=d("main"),L(n.$$.fragment),i=p(),L(r.$$.fragment),m(e,"class","svelte-g2cdjv")},m(t,s){h(t,e,s),N(n,e,null),c(e,i),N(r,e,null),l=!0},p(t,[e]){const i={};!s&&1&e&&(s=!0,i.camoPattern=t[0],T((()=>s=!1))),!o&&2&e&&(o=!0,i.colorPalette=t[1],T((()=>o=!1))),n.$set(i);const l={};1&e&&(l.pattern=t[0]),2&e&&(l.color=t[1]),r.$set(l)},i(t){l||(D(n.$$.fragment,t),D(r.$$.fragment,t),l=!0)},o(t){B(n.$$.fragment,t),B(r.$$.fragment,t),l=!1},d(t){t&&u(e),H(n),H(r)}}}function Gt(t,e,n){let s,{name:o}=e,i="green";return t.$$set=t=>{"name"in t&&n(2,o=t.name)},[s,i,o,function(t){s=t,n(0,s)},function(t){i=t,n(1,i)}]}return new class extends J{constructor(t){super(),z(this,t,Gt,jt,i,{name:2})}}({target:document.body,props:{name:"world"}})}();
